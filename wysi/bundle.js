(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.wysi = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var sel=getSelection();if(Selection.prototype.getRange=function(){return sel.rangeCount?sel.getRangeAt(0):new Range},Selection.prototype.setRange=function(e){sel.removeAllRanges(),sel.addRange(e)},Selection.prototype.selectNode=function(e){var t=new Range;return t.selectNode(e),t},Selection.prototype.selectNodeContents=function(e,t){var n=new Range;return n.selectNodeContents(e),void 0!==t&&n.collapse(t),n},Node.prototype.attr=function(e){if(!e){for(var t={},n=this.attributes,o=Array.isArray(n),r=0,n=o?n:n[Symbol.iterator]();;){var i;if(o){if(r>=n.length)break;i=n[r++]}else{if(r=n.next(),r.done)break;i=r.value}var a=i;t[a.name]=a.value}return t}for(var s in e)this.setAttribute(s,e[s]);return this},Node.prototype.css=function(e){return Object.assign(this.style,e),this},Element.prototype.rect=Element.prototype.getBoundingClientRect,Range.prototype.rect=Range.prototype.getBoundingClientRect,Range.prototype.start=function(){return this.startContainer.childNodes[this.startOffset]||this.startContainer},Range.prototype.closest=function(e){return this.commonAncestorContainer.closest(e)},Text.prototype.closest=function(e){return this.parentNode.closest(e)},Text.prototype.matches=function(e){return null},Document.prototype.closest=function(){return null},Document.prototype.matches=function(){return null},document.execCommand("styleWithCSS",null,!0),/edge|chrom/i.test(navigator.userAgent)&&document.body.addEventListener("mousedown",function(e){"IMG"===e.target.tagName&&e.target.isContentEditable&&sel.setRange(sel.selectNode(e.target))}),/firefox\/[0-4]/i.test(navigator.userAgent)&&!function(){var e=function(e){var t=n.getRange();0===t.compareBoundaryPoints(Range.START_TO_START,o)&&0===t.compareBoundaryPoints(Range.END_TO_END,o)||document.dispatchEvent(new CustomEvent("selectionchange",{detail:e})),o=t},t=function(e,t){var n=0;return function(o){var r=this,i=Date.now();i-n>t&&(n=i,setTimeout(function(t){return e.call(r,o)}))}},n=getSelection(),o=new Range;document.addEventListener("mousedown",function(t){return setTimeout(function(n){return e(t)})}),document.addEventListener("mouseup",function(t){return setTimeout(function(n){return e(t)})}),document.addEventListener("drop",e),document.addEventListener("mousemove",t(e,50)),document.addEventListener("keydown",t(e,100)),document.addEventListener("keyup",e)}(),/firefox/i.test(navigator.userAgent)&&(console.log("Firefox fixes"),window.addEventListener("DOMContentLoaded",function(e){document.execCommand("enableInlineTableEditing",null,!1),document.execCommand("enableObjectResizing",null,!1),document.execCommand("styleWithCSS",null,!0)})),/edge/i.test(navigator.userAgent)){console.log("edge fixes");for(var _arr=[NodeList,HTMLCollection,NamedNodeMap,CSSStyleDeclaration,CSSRuleList],_i2=0;_i2<_arr.length;_i2++){var cls=_arr[_i2];cls.prototype[Symbol.iterator]||(cls.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator])}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t&&!t.matches(e);)t=t.parentNode;return t})}

},{}],2:[function(require,module,exports){
module.exports={

	"inline": ["bold","italic", "underline","strikethrough","superscript","subscript"],

	"justify": ["justifyLeft","justifyCenter","justifyRight","justifyFull"],
	"justifyFa": {
		"justifyLeft":"align-left",
		"justifyCenter":"align-center",
		"justifyRight":"align-right",
		"justifyFull":"align-justify"
	},


	"list": ["insertUnorderedList", "insertOrderedList","indent","outdent"],
	"listFa": {
		"insertUnorderedList":"list-ul",
		"insertOrderedList":"list-ol",
		"outdent":"outdent",
		"indent":"indent"
	},


	"block": ["h1","h2","h3","p", "blockquote","pre"],
	"blockValue": {
		"div":"Normal",
		"p":"Paragraph",
		"h1":"Heading 1",
		"h2":"Heading 2",
		"h3":"Heading 3",
		"pre":"Preformatted",
		"blockquote":"Quote",
		"h4":"Heading 4",
		"h5":"Heading 5",
		"h6":"Heading 6"
	},

	"fontname": ["Noto Sans", "Times New Roman", "Arial", "Arial Black", "Calibri", "Georgia", "Segoe UI", "Verdana", "Cursive", "Impact", "Consolas", "Courier New"],
	"fontnameValue": {
		"Noto Sans": "Noto Sans",
		"Arial":"Arial",
		"sans-serif": "Arial",
		"Arial Black": "Arial Black",
		"Segoe UI": "Segoe UI",
		"Calibri": "Calibri",
		"Georgia": "Georgia",
		"serif": "Times New Roman",
		"Times New Roman":"Times New Roman",
		"cursive": "Cursive",
		"Impact": "Impact",
		"Verdana": "Verdana",
		"Consolas": "Consolas",
		"Courier New": "Courier New"
	},

	"fontsize": ["1", "2", "3", "4", "5", "6", "7"],
	"fontsizeValue": {"1":10, "2":13, "3":16, "4":18, "5":24, "6":32, "7":48},
	"fontsizeName": {"x-small":10, "small":13, "large":18, "x-large":24, "xx-large":32, "-webkit-xxx-large":48},

	"float": ["right","left"],
	"floatFa": {"left": "long-arrow-left", "right": "long-arrow-right"},

	"margin": ["top", "right", "bottom", "left"],
	"marginValues": ["0", "5px", "10px", "20px", "auto"],

	"padding": ["0", "2px", "2px 5px", "5px", "10px", "10px 20px", "20px"],

	"verticalAlign": ["top", "middle", "bottom"],

	"border": ["border", "borderTop", "borderRight",  "borderBottom","borderLeft"],

	"borderStyle": ["double", "solid", "dotted", "dashed", "none", "inset", "outset"],

	"borderWidth": ["thin", "medium", "thick", 0],

	"borderCollapse": ["collapse", "separate"],

	"table_picker": {"m_max":20, "m_min":1, "n_max": 20, "n_min": 1},

	"palette": [
		"rgb(56, 228, 50)",
		"rgb(244, 56, 56)",
		"rgb(44, 120, 244)",

		"rgb(15, 160, 90)",
		"rgb(240, 180, 0)",
		"rgb(85, 170, 238)",

		"rgb(20, 10, 80)",
		"rgb(150, 20, 180)",
		"rgb(230, 230, 220)"
	]

}
},{}],3:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,equals=_require.equals,ImageModal=require("./ImageModal.js"),ImageTools=require("./ImageTools.js"),LinkEdit=require("./LinkEdit.js"),TableTools=require("./TableTools.js"),TableResizer=require("./TableResizer.js"),Toolbar=require("./Toolbar.js"),cfg=require("../config.json"),sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e,t){return!equals(t,this.state)||e.children!==this.props.children},getInitialState:function(){return{a:null,img:!1,aForm:{href:"",target:"_blank",rel:""},imgForm:{src:""},aR:null,imgR:null,ce:void 0,cm:!1,xs:!1,imgs:[{url:"//searchengineland.com/figz/wp-content/seloads/2015/11/teamwork-meeting-collaboration-ss-1920.jpg",title:"People"},{url:"//i.imgur.com/QxsAb7s.jpg",title:"Work"},{url:"https://c4.staticflickr.com/3/2926/14690771011_945f91045a_b.jpg",title:"Cool"},{url:"https://c4.staticflickr.com/7/6117/7029086763_80a4390fda_c.jpg",title:"Castle"}].concat(Array.from({length:9},function(e,t){return{url:"//placekitten.com/600/"+(400+Math.round(100*Math.random()))+"?image="+(t+1)+"#.jpg",title:"Cat "+(t+1)}}))}},update:function(e){this.setState(e)},componentDidMount:function(){require("./utils/pasteparser.js")(),require("./utils/autoinsertlink.js")();var e=require("./utils/lightbox.js");e.listen()},render:function(){var e=this.state,t=e.a,r=e.img,i=e.aForm,a=e.imgForm,s=e.aR,l=e.imgR,o=e.ce,u=e.cm,n=e.xs,c=e.imgs;return v("div",{className:"wysi",ref:"el"},v(ImageTools,{img:r,update:this.update}),v(ImageModal,{imgForm:a,imgR:l,imgs:c,update:this.update}),v(LinkEdit,{aForm:i,aR:s,update:this.update}),v(TableResizer),v(TableTools),v(Toolbar,{ref:"tb",a:t,img:r,ce:o,cm:u,xs:n,update:this.update},this.props.children))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./ImageModal.js":4,"./ImageTools.js":5,"./LinkEdit.js":6,"./TableResizer.js":7,"./TableTools.js":8,"./Toolbar.js":9,"./utils/":11,"./utils/autoinsertlink.js":10,"./utils/lightbox.js":12,"./utils/pasteparser.js":13}],4:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,h=_require.h,loadScript=_require.loadScript,insertImage=_require.insertImage,equals=_require.equals,loadImage=_require.loadImage,base64=_require.base64,exec=_require.exec,sel=getSelection();module.exports=React.createClass({getInitialState:function(){return{}},shouldComponentUpdate:function(e){return!equals(e,this.props)},componentDidMount:function(){var e=this;this.input=h("input",{type:"file",accept:"image/*",multiple:!0,title:"Click to add your images, or drop them",onChange:function(t){return e.addImages(t.target.files)}}),this.apply=this.props.apply||function(t,i){var r=e.props,n=r.imgR,a=r.imgForm,o=n.cloneContents().firstChild;o&&"IMG"===o.tagName||(o=new Image),o.attr({src:i.url,title:i.title,style:a.style}),sel.setRange(n),insertImage(o),e.close()},document.addEventListener("dblclick",function(t){document.activeElement.isContentEditable&&t.target.matches("[contenteditable=true] img")&&setTimeout(function(i){return e.props.update({imgR:sel.selectNode(t.target),imgForm:t.target.attr()})})}),document.addEventListener("paste",function(t){var i=t.clipboardData.getData("text");return e.props.imgR&&i?e.addImage(i):void Promise.all(Array.prototype.filter.call(t.clipboardData.items,function(e){return"file"==e.kind&&e.type.startsWith("image")}).map(function(e){return URL.createObjectURL(e.getAsFile())})).then(function(t){e.props.update({imgs:t.map(function(e){return{url:e,title:"",type:"img"}}).concat(e.props.imgs)}),e.props.imgR||t.forEach(function(e){return exec("insertImage",e)})})}),loadScript({src:"//crossorigin.me/http://feather.aviary.com/imaging/v3/editor.js",onload:function(){e.editor=new Aviary.Feather({apiKey:localStorage.aviaryKey||"fe87002a-3c50-4eb8-be2e-b7cd5ce0efc0",theme:"dark",tools:"all",appendTo:"",onSave:function(t,i){e.editing.url=i,e.props.update({imgs:e.props.imgs.slice(),imgForm:{src:i}}),e.editor.close()},onError:function(e){console.log(e.message)}})}}),this.editorImg=document.body.appendChild(h("img",{id:"avImg",hidden:!0,src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})),this.launch=function(t){return e.editor.launch({image:e.editorImg.id,url:t})}},edit:function(e,t){e.stopPropagation(),this.editing=t,t.url.startsWith("blob")?fetch(t.url).then(function(e){return e.blob()}).then(base64).then(this.launch):this.launch(t.url)},drop:function(e){e.stopPropagation(),e.preventDefault(),this.addImages(e.dataTransfer.files)},dragOver:function(e){e.stopPropagation(),e.preventDefault()},addImages:function(e){var t=this;Promise.all(Array.from(e).filter(function(e){return e.type.startsWith("image")}).map(URL.createObjectURL)).then(function(i){t.props.update({imgs:[].concat(i.map(function(t,i){return{url:t,type:"img",time:e[i].lastModified,title:e[i].name.replace(/.\w+$/,"")}}),t.props.imgs)}),t.refs.input.className=""})},addImage:function(e){var t=this,i=this.props.imgs,r=i.findIndex(function(t){return t.url===e});r>=0||loadImage(e).then(function(e){t.props.update({imgs:[{url:e.src,title:"",type:"img"}].concat(i)}),t.refs.input.className=""}).catch(function(e){t.refs.input.className="error",console.log("bad url",e)})},close:function(){this.props.update({imgR:null,img:null})},keydown:function(e){27===e.keyCode&&this.close()},componentDidUpdate:function(e){!e.imgR&&this.props.imgR?document.addEventListener("keydown",this.keydown):e.imgR&&!this.props.imgR&&document.removeEventListener("keydown",this.keydown)},setForm:function(e){this.props.update({imgForm:Object.assign({},this.props.imgForm,e)})},render:function(){var e=this,t=this.props,i=t.imgForm,r=t.imgs;return v("div",{className:"modal "+(this.props.imgR?"active":""),onClick:function(t){return t.currentTarget===t.target&&e.close()},onDrop:this.drop,onDragOver:this.dragOver,onKeyDown:this.keydown},v("div",v("form",{onSubmit:function(t){e.addImage(i.src),t.preventDefault()}},v("input",{type:"search",title:"Press enter to submit",name:"img",value:i.src,ref:"input",placeholder:"Paste an image url",onChange:function(t){return e.setForm({src:t.target.value})}}),v("i",{className:"fa fa-upload",title:"Click to add your images, or drop them",onClick:function(t){return e.input.click()}})),v("div",{className:"scroll"},v("div",{className:"image-picker"},r.map(function(t,n){return v("figure",{key:n,className:t.url===i.src?"selected":null},v("img",{src:t.url,onClick:function(i){return e.apply(i,t)}}),v("div",v("input",{value:t.title,onChange:function(i){t.title=i.target.value,e.props.update({imgs:r.slice()})}}),v("i",{className:"fa fa-trash",title:"Delete image",onClick:function(i){URL.revokeObjectURL(t.url),e.props.update({imgs:r.slice(0,n).concat(r.slice(n+1))})}}),e.editor&&v("i",{className:"fa fa-magic",title:"Edit image",onClick:function(i){return e.edit(i,t)}})))})))))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./utils/":11}],5:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,insertImage=_require.insertImage,StyleWidget=require("./widgets/StyleWidget.js"),_require2=require("../config.json"),float=_require2.float,padding=_require2.padding,max=Math.max,sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e){return this.props.img!==e.img},componentDidMount:function(){var e=this;document.addEventListener("selectionchange",function(t){var s=sel.getRange().start();e.props.update({img:document.activeElement.isContentEditable&&"IMG"===s.tagName&&!sel.isCollapsed&&s})}),window.addEventListener("resize",function(t){e.props.img&&e.refs.el.css(popOver(e.props.img.rect()))})},startResize:function(e){var t=this,s=this.props.img.rect(),i=function e(i){var n=t.props.img.cloneNode(!0);t.props.img.style.width=s.width;var o=insertImage(n);document.removeEventListener("mouseup",e),document.removeEventListener("mousemove",r),t.props.update({img:o})},r=function(i){1===e?t.props.img.style.width=max(25,i.clientX-s.left)+"px":2===e&&(t.props.img.style.width=max(25,s.right-i.clientX)+"px"),t.refs.el.css(popOver(t.props.img.rect()))};document.addEventListener("mouseup",i),document.addEventListener("mousemove",r)},reset:function(e){var t=this.props.img.cloneNode(!0).css({width:""});insertImage(t)},imgStyle:function(e){var t=this,s=this.props.img.cloneNode(!0);s.css(e);var i=insertImage(s);i&&setTimeout(function(e){i.closest("a")&&(i.closest("a").style.float=i.style.float),t.refs.el.css(popOver(i.rect()))})},render:function(){var e=this,t=this.props.img,s=t?popOver(t.rect()):null;return v("div",{className:"image-tools"+(t&&"right"===t.style.float?" right":""),ref:"el",style:s,hidden:!t,onMouseDown:function(e){return e.preventDefault()}},v("div",v(StyleWidget,{name:"float",cmd:this.imgStyle,el:t,values:float,label:v("i",{className:"fa fa-arrows-h"})}),v(StyleWidget,{name:"margin",cmd:this.imgStyle,el:t,values:padding,label:v("i",{className:"fa fa-square-o"})})),v("div",{className:"handle se",onMouseDown:function(t){return e.startResize(1)},onDoubleClick:this.reset}),v("div",{className:"handle ne",onMouseDown:function(t){return e.startResize(1)},onDoubleClick:this.reset}),v("div",{className:"handle sw",onMouseDown:function(t){return e.startResize(2)},onDoubleClick:this.reset}),v("div",{className:"handle nw",onMouseDown:function(t){return e.startResize(2)},onDoubleClick:this.reset}))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./utils/":11,"./widgets/StyleWidget.js":20}],6:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,exec=_require.exec,equals=_require.equals,lightbox=require("./utils/lightbox.js"),sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e){return!equals(e,this.props)},componentDidMount:function(){var e=this;window.addEventListener("resize",function(t){e.props.aR&&e.refs.el.css(popOver(e.props.aR.rect()))}),this.apply=this.props.apply||function(t){t.preventDefault();var a=e.props,n=a.aR,r=a.aForm;sel.setRange(n);var o="IMG"===n.start().tagName&&n.start().style.float;o&&(n.start().style.float="",n.closest("a")&&(n.closest("a").style.float="")),exec("createLink",r.href),n=sel.getRange();var l=n.start().closest("a");if(l){l.rel=r.rel,l.target=r.target;var i=l.querySelector("img");i&&o&&(l.style.float=i.style.float=o)}else console.log("failed to insert <a>, chrome float:right bug");e.props.update({aR:null})},document.addEventListener("selectionchange",function(t){e.refs.el.contains(document.activeElement)||e.props.update({a:document.activeElement.isContentEditable&&sel.getRange().closest("a"),aR:null})}),document.addEventListener("dblclick",function(t){if(document.activeElement.isContentEditable){var a=t.target.closest("[contenteditable=true] a");a&&setTimeout(function(t){return e.props.update({aR:sel.selectNode(a),aForm:Object.assign({target:"_blank",rel:""},a.attr())})})}})},setForm:function(e,t){this.props.update({aForm:Object.assign({},this.props.aForm,e)}),this.refs.input.focus()},render:function(){var e=this,t=this.props,a=t.aR,n=t.aForm,r=void 0,o=void 0;if(a){var l=a.rect();r=0!=l.width||0!=l.height||0!=l.left||0!=l.top?popOver(l):null;var i=l.left<120,s=l.right>window.innerWidth-120;l.width<272&&(i||s)&&(o=i?{right:"auto"}:{left:"auto"})}return v("div",{className:"link-edit",ref:"el",style:r,onMouseDown:function(e){return"INPUT"!==e.target.tagName&&e.preventDefault()}},v("form",{onSubmit:this.apply,style:o},v("div",{className:"row"},v("label",{className:"fa fa-external-link",title:"Open in new window"},v("input",{type:"checkbox",name:"opening",checked:"_blank"===n.target,onChange:function(t){return e.setForm({target:t.target.checked?"_blank":""})}})),v("label",{className:"fa fa-expand",title:"Open in lighbox\nonly images, videos (.png, .jpg, .webm, ...)\nor embed links (youtube, vimeo, maps...)"},v("input",{type:"checkbox",name:"opening",checked:"lightbox"===n.target,onChange:function(t){return e.setForm({target:t.target.checked?"lightbox":""})},disabled:!lightbox.accepts(n.href)})),v("label",{className:"fa fa-ban",title:"No follow"},v("input",{type:"checkbox",checked:n.rel,onChange:function(t){return e.setForm({rel:t.target.checked?"nofollow":""})}})),v("i",{className:"fa fa-remove",title:"Remove link",onClick:function(t){t.preventDefault(),sel.setRange(a),exec("unlink"),e.props.update({aR:null})}})),v("div",{className:"row"},v("input",{type:"search",ref:"input",autoComplete:"on",name:"url",value:n.href,onChange:function(t){return e.setForm({href:t.target.value})}}),v("input",{type:"submit",value:"âœ“"}))))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./utils/":11,"./utils/lightbox.js":12}],7:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,argMin=_require.argMin,tableToMatrix=_require.tableToMatrix,exec=_require.exec,insertNode=_require.insertNode,min=Math.min,max=Math.max,abs=Math.abs,round=Math.round,sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(){return!1},rowMouseDown:function(){var e=this,t=this.tbl,s=this.td,o=this.iY,r=tableToMatrix(t),i=s.parentNode.rowIndex+(o?s.rowSpan:0),n=void 0;this.i=i,this.refs.row.classList.add("moving");var l=t.rect();n=0===i?[0,l.bottom,l.top]:i===t.rows.length?[l.top,1/0,l.top]:[t.rows[i-1].rect().top,t.rows[i].rect().bottom,l.top];var a=function(t){e.refs.row.style.top=min(max(n[0],t.clientY),n[1])-n[2]+"px"},f=function s(o){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",s);var n=e.refs.row.offsetTop+4,l=t.cloneNode(!0);if(0===i){var f=parseFloat(t.style.marginTop)||0;f+n<0&&(n=-f),l.style.marginTop=f+n?f+n+"px":"",l.style.height=t.offsetHeight-n+1+"px"}else if(i===r.length)l.style.height=n+"px";else{var d=n-t.rows[i-1].offsetTop,c=t.rows[i].offsetTop+t.rows[i].offsetHeight-n;l.rows[i-1].style.height=round(d/t.offsetHeight*100)+"%",l.rows[i].style.height=round(c/t.offsetHeight*100)+"%"}sel.setRange(sel.selectNode(t)),e.tbl=insertNode(l),e.refs.row.classList.remove("moving"),e.refs.el.css({left:""})};document.addEventListener("mouseup",f),document.addEventListener("mousemove",a)},colMouseDown:function(){var e=this,t=this.tbl,s=this.td,o=this.iX,r=tableToMatrix(t),i=r[s.parentNode.rowIndex].indexOf(s)+(o?s.colSpan:0),n=void 0;this.j=i,this.refs.col.classList.add("moving");var l=t.rect();if(0===i)n=[t.parentNode.rect().left,l.right,l.left];else if(i===r[0].length)n=[l.left,t.parentNode.rect().right,l.left];else{n=[l.left,l.right,l.left];for(var a=0;a<r.length;a++)n[0]=max(n[0],r[a][i-1].rect().left),n[1]=min(n[1],r[a][i].rect().right)}var f=function(t){e.refs.col.style.left=min(max(n[0],t.clientX),n[1])-n[2]+"px"},d=function s(o){document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",s);var n=e.refs.col.offsetLeft+4,l=t.cloneNode(!0),a=tableToMatrix(l);if(0===i){var d=round(100*n/t.parentNode.offsetWidth),c=parseFloat(t.style.marginLeft)||0,h=round(100*t.offsetWidth/t.parentNode.offsetWidth),u=d+c<1?0:d+c,v=h+c-u;l.css({marginLeft:u+"%",width:v+"%"})}else if(i===r[0].length){var p=round(100*n/t.parentNode.offsetWidth),m=parseFloat(t.style.marginLeft)||0;m+p>99&&(p=100-m),l.style.width=p+"%"}else for(var g=0;g<r.length;g++)r[g][i-1]!==r[g][i]&&(a[g][i-1].style.width=round((n-r[g][i-1].offsetLeft)/t.offsetWidth*100)+"%",a[g][i].style.width=round((r[g][i].offsetLeft+r[g][i].offsetWidth-n)/t.offsetWidth*100)+"%");sel.setRange(sel.selectNode(t)),e.tbl=insertNode(l),e.refs.col.classList.remove("moving"),e.refs.el.css({left:""})};document.addEventListener("mouseup",d),document.addEventListener("mousemove",f)},colReset:function(e){var t=this.tbl,s=this.j,o=tableToMatrix(t),r=t.cloneNode(!0),i=tableToMatrix(r);if(0===s){var n=parseFloat(t.style.marginLeft)||0,l=parseFloat(t.style.width)||0;r.style.marginLeft="",l&&(r.style.width=l+n+"%")}else if(s===o[0].length)r.style.width="";else for(var a=0;a<o.length;a++)o[a][s-1]!==o[a][s]&&(i[a][s-1].style.width="",i[a][s].style.width="");sel.setRange(sel.selectNode(t)),insertNode(r),this.refs.el.css({left:""})},rowReset:function(e){var t=this.tbl,s=this.i,o=t.cloneNode(!0);if(0===s){var r=parseFloat(t.style.marginTop)||0,i=parseFloat(t.style.height)||0;o.style.marginTop="",i&&(o.style.height=i+r+"px")}else s===t.rows.length?o.style.height="":(o.rows[s-1].style.height="",o.rows[s].style.height="");sel.setRange(sel.selectNode(t)),insertNode(o),this.refs.el.css({left:""})},componentDidMount:function(){var e=this;document.addEventListener("mouseover",function(t){if(t.target.isContentEditable){var s=t.target.closest("[contenteditable=true] td");if(s){var o=s.closest("table");if(!o)return console.log("DEBUG: no parent table for td?");var r=s.rect(),i=argMin(abs(t.clientX-r.left),abs(t.clientX-r.right)),n=i[0],l=i[1],a=argMin(abs(t.clientY-r.top),abs(t.clientY-r.bottom)),f=a[0],d=a[1];l<4?(e.refs.col.style.left=s.offsetLeft+(n?s.offsetWidth:0)+"px",e.refs.el.css(popOver(o.rect())),Object.assign(e,{td:s,tbl:o,iX:n,iY:f})):d<4&&(e.refs.row.style.top=f?offsetBottom(o.rows[s.parentNode.rowIndex+s.rowSpan-1])+"px":s.parentNode.offsetTop+"px",e.refs.el.css(popOver(o.rect())),Object.assign(e,{td:s,tbl:o,iX:n,iY:f}))}}}),window.addEventListener("resize",function(t){e.refs.el.style.left&&e.refs.el.css({left:""})})},clear:function(){this.tbl.parentNode||this.refs.el.css({left:""})},render:function(){return v("div",{className:"table-resizer",ref:"el",onMouseEnter:this.clear},v("div",{className:"row-resize",ref:"row",onMouseDown:this.rowMouseDown,onDoubleClick:this.rowReset},v("div")),v("div",{className:"col-resize",ref:"col",onMouseDown:this.colMouseDown,onDoubleClick:this.colReset},v("div")))}});var offsetBottom=function(e){return e.offsetTop+e.offsetHeight};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./utils/":11}],8:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver2=_require.popOver2,tableToMatrix=_require.tableToMatrix,matrixToTable=_require.matrixToTable,dropdown=_require.dropdown,tabs=_require.tabs,_exec=_require.exec,insertNode=_require.insertNode,StyleWidget=require("./widgets/StyleWidget.js"),StyleColorWidget=require("./widgets/StyleColorWidget.js"),StyleBorderWidget=require("./widgets/StyleBorderWidget.js"),_require2=require("../config.json"),palette=_require2.palette,borderWidth=_require2.borderWidth,borderStyle=_require2.borderStyle,padding=_require2.padding,borderCollapse=_require2.borderCollapse,verticalAlign=_require2.verticalAlign,tableExec=require("./utils/tablecommands.js"),sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e){return this.state.s!==e.s},getInitialState:function(){return{s:null,M:null}},exec:function(e,t){var l=this.state,r=l.s,a=l.M,i=a.t.cloneNode(!0),n=tableToMatrix(i),o=tableExec[e](r,n,t);if(sel.setRange(sel.selectNode(a.t)),n.length&&n[0].length){var s=matrixToTable(n);i.innerHTML="",i.appendChild(s),n=tableToMatrix(insertNode(i)),this.setState({s:o,M:n})}else _exec("insertHTML","<br>"),this.setState({s:null,M:null})},cellStyle:function(e){this.exec("cellStyle",e)},tableStyle:function(e){var t=this.state.M,l=t.t.cloneNode(!0);l.css(e),sel.setRange(sel.selectNode(t.t));var r=tableToMatrix(insertNode(l));this.setState({s:this.state.s.slice(),M:r})},componentDidMount:function(){var e=this;require("./utils/tableselection.js")(),document.addEventListener("tableselectionchange",function(t){var l=t.detail;"end"===l.type&&setTimeout(function(t){return e.setState({s:l.s,M:l.M})})}),window.addEventListener("resize",function(t){if(e.state.s){var l=e.state,r=l.s,a=l.M,i=a[r[0]][r[1]],n=a[r[2]][r[3]];e.refs.el.css(popOver2(i.rect(),n.rect()))}})},componentDidUpdate:function(e,t){var l=this;!t.s&&this.state.s&&!function(){var e=function e(r){l.setState({s:null,M:null}),document.removeEventListener("keydown",e),document.removeEventListener("mousedown",t)},t=function(t){return!l.refs.el.contains(t.target)&&e()};document.addEventListener("keydown",e),document.addEventListener("mousedown",t)}()},render:function(){var e=this,t=this.state,l=t.s,r=t.M,a=void 0,i=void 0,n=void 0,o=void 0;return l&&(a=r[l[0]][l[1]],i=r[l[2]][l[3]],o=r.t,(sel.isCollapsed||a!==i)&&(n=popOver2(a.rect(),i.rect()))),v("div",{className:"table-tools",ref:"el",style:n},v("div",v("i",{className:"fa fa-caret-left",onClick:function(t){return e.exec("addCol",0)}}),v("i",{className:"fa fa-remove",onClick:function(t){return e.exec("delCols")}}),v("i",{className:"fa fa-caret-right",onClick:function(t){return e.exec("addCol",1)}})),v("div",v("i",{className:"fa fa-caret-up",onClick:function(t){return e.exec("addRow",0)}}),v("i",{className:"fa fa-remove",onClick:function(t){return e.exec("delRows")}}),v("i",{className:"fa fa-caret-down",onClick:function(t){return e.exec("addRow",1)}})),v("div",v("i",{className:"fa fa-compress",onClick:function(t){return e.exec("merge")}}),dropdown({name:"table-style",closeOn:null,label:v("i",{className:"fa fa-pencil"}),content:tabs({name:"t-s-tabs",children:[{label:"Cell",content:v("ul",v(StyleBorderWidget,{el:i,cmd:this.cellStyle,tab:1,palette:palette,borderWidth:borderWidth,borderStyle:borderStyle}),v("li",v("span","background"),v(StyleColorWidget,{name:"backgroundColor",tab:1,cmd:this.cellStyle,el:i,values:palette})),v("li",v("span","padding"),v(StyleWidget,{name:"padding",cmd:this.cellStyle,el:i,values:padding})),v("li",v("span","vertical-align"),v(StyleWidget,{name:"verticalAlign",cmd:this.cellStyle,el:i,values:verticalAlign})))},{label:"Table",content:v("ul",v(StyleBorderWidget,{el:o,cmd:this.tableStyle,tab:2,palette:palette,borderWidth:borderWidth,borderStyle:borderStyle}),v("li",v("span","background"),v(StyleColorWidget,{name:"backgroundColor",tab:2,cmd:this.tableStyle,el:o,values:palette})),v("li",v("span","border-collapse"),v(StyleWidget,{name:"borderCollapse",cmd:this.tableStyle,el:o,values:borderCollapse})),v("li",v("span","align"),v("span",v("button",{onMouseUp:function(t){return e.tableStyle({marginLeft:"",marginRight:""})}},v("i",{className:"fa fa-align-left"})),v("button",{onMouseUp:function(t){return e.tableStyle({marginLeft:"auto",marginRight:"auto"})}},v("i",{className:"fa fa-align-center"})),v("button",{onMouseUp:function(t){return e.tableStyle({marginLeft:"auto",marginRight:0})}},v("i",{className:"fa fa-align-right"})))))}]})})))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./utils/":11,"./utils/tablecommands.js":15,"./utils/tableselection.js":16,"./widgets/StyleBorderWidget.js":18,"./widgets/StyleColorWidget.js":19,"./widgets/StyleWidget.js":20}],9:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,equals=_require.equals,loadScript=_require.loadScript,exec=_require.exec,execNoCss=_require.execNoCss,expandStart=_require.expandStart,expandEnd=_require.expandEnd,formatBlock=_require.formatBlock,Menu=_require.Menu,drophover=_require.drophover,tabs=_require.tabs,TablePicker=require("./widgets/TablePicker.js"),IconPicker=require("./widgets/IconPicker.js"),stringify=require("./utils/stringifyhtml.js"),cfg=require("../config.json"),max=Math.max,min=Math.min,sign=Math.sign,sel=getSelection(),exec2=function(e,t){exec(e,t),document.dispatchEvent(new Event("selectionchange"))},execNoCss2=function(e,t){execNoCss(e,t),document.dispatchEvent(new Event("selectionchange"))},queryCommandFontName=function(e){var t=document.queryCommandValue("fontname")||"",n=t.split(",")[0].replace(/^["'\s]+|["'\s]+$/g,"");return cfg.fontnameValue[n]||n},queryCommandFontSize=function(e){var t=document.queryCommandValue("fontsize");if(cfg.fontsizeValue.hasOwnProperty(t))return cfg.fontsizeValue[t];var n=sel.getRange().closest("*");return n?parseInt(getComputedStyle(n).fontSize):16},commandStates=function(e){for(var t={},n=e,o=Array.isArray(n),r=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(r>=n.length)break;a=n[r++]}else{if(r=n.next(),r.done)break;a=r.value}var s=a;t[s]=document.queryCommandState(s)}return t},BlockMenu=Menu({mount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.setState({value:document.queryCommandValue("formatblock")})})},render:function(){var e=this;return drophover({name:"formatblock",label:v("i",{className:"fa fa-paragraph"}),content:v("ul",cfg.block.map(function(t,n){return v("li",{key:n,onMouseUp:function(e){return formatBlock(t)},className:t===e.state.value?"selected":null},v(t,cfg.blockValue[t]))}))})}}),FontNameMenu=Menu({mount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.setState({value:queryCommandFontName()})})},render:function(){var e=this;return drophover({name:"fontname",label:v("i",{className:"fa",style:{fontFamily:this.state.value}},this.state.value),content:v("ul",{className:"scroll"},cfg.fontname.map(function(t,n){return v("li",{key:n,onMouseUp:function(e){return exec2("fontname",t)},className:t===e.state.value?"selected":null},v("span",{style:{fontFamily:t}},t))}))})}}),FontSizeMenu=Menu({mount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.setState({value:document.queryCommandValue("fontsize")})})},render:function(){var e=this;return drophover({name:"fontsize",label:v("i",{className:"fa"},queryCommandFontSize()),content:v("ul",cfg.fontsize.map(function(t,n){return v("li",{key:n,onMouseUp:function(e){return exec2("fontsize",t)},className:t===e.state.value?"selected":null},cfg.fontsizeValue[t])})),onWheel:document.queryCommandSupported("fontSizeDelta")&&function(t){t.preventDefault(),exec("fontsizeDelta",sign(t.deltaY)),e.setState({value:document.queryCommandValue("fontsize")})}})}}),ColorMenu=Menu({mount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.setState({forecolor:document.queryCommandValue("forecolor"),backcolor:document.queryCommandValue("backcolor")})})},render:function(){var e=this;return drophover({name:"color",closeOn:"button",label:v("i",{className:"fa fa-tint",style:{color:this.state.forecolor,backgroundColor:this.state.backcolor}}),content:tabs({name:"color-picker",children:[{label:"Text",content:v("div",{className:"palette"},cfg.palette.map(function(t,n){return v("button",{key:n,className:t===e.state.forecolor?"selected":null,onMouseUp:function(n){return exec2("forecolor",t===e.state.forecolor?"inherit":t)},style:{backgroundColor:t}})}))},{label:"Background",content:v("div",{className:"palette"},cfg.palette.map(function(t,n){return v("button",{key:n,className:t===e.state.backcolor?"selected":null,onMouseUp:function(n){return exec2("backcolor",t===e.state.backcolor?"inherit":t)},style:{backgroundColor:t}})}))}]})})}}),InlineMenu=Menu({mount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.setState(commandStates(cfg.inline))})},render:function(){return drophover({name:"inline",label:v("i",{className:"fa fa-bold"}),content:v("ul",cfg.inline.map(function(e,t){return v("li",{key:t,onMouseUp:function(t){return execNoCss2(e)},className:document.queryCommandState(e)?"selected":null},v("i",{className:"fa fa-"+e}))}))})}}),JustifyMenu=Menu({mount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.setState(commandStates(cfg.justify))})},render:function(){return drophover({name:"justify",label:v("i",{className:"fa fa-"+cfg.justifyFa[cfg.justify.find(function(e){return document.queryCommandState(e)})||"justifyLeft"]}),content:v("ul",cfg.justify.map(function(e,t){return v("li",{key:t,onMouseUp:function(t){exec2(e),setTimeout(function(e){return window.dispatchEvent(new Event("resize"))})},className:document.queryCommandState(e)?"selected":null},v("i",{className:"fa fa-"+cfg.justifyFa[e]}))}))})}}),ListMenu=Menu({mount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.setState(commandStates(cfg.list))})},render:function(){return drophover({name:"list",label:v("i",{className:"fa fa-list-"+(document.queryCommandState("insertorderedlist")?"ol":"ul")}),content:v("ul",cfg.list.map(function(e,t){return v("li",{key:t,onMouseUp:function(t){return exec2(e)},className:document.queryCommandState(e)?"selected":null},v("i",{className:"fa fa-"+cfg.listFa[e]}))}))})}});module.exports=React.createClass({getInitialState:function(){return{}},shouldComponentUpdate:function(e,t){return!equals(e,this.props)||t.CM!==this.state.CM},newLink:function(e){if(!this.props.cm){var t={href:"",target:"_blank",rel:""},n=sel.getRange().cloneRange(),o=n.startContainer.closest("a"),r=n.endContainer.closest("a");if(o||r)o&&n.setStartBefore(o),r&&n.setEndAfter(r),Object.assign(t,(o||r).attr());else if("IMG"!==n.start().tagName||n.start().src.startsWith("data")){expandStart(n),expandEnd(n);var a=n.cloneRange(),s=n.cloneRange();a.collapse(!1),expandStart(a,/[^.,;!?]/),n.setEnd(a.startContainer,a.startOffset),s.collapse(!0),expandEnd(s,/\S/),n.setStart(s.endContainer,s.endOffset);var i=n.toString().trim().match(/^(https?:\/\/|tel:|mailto:)(.*)/);i&&(t.href=i[2])}else t.href=n.start().src;this.props.update({aR:n,aForm:t})}},newImage:function(e){if(!this.props.cm){var t=sel.getRange(),n=t.cloneContents().querySelector("img");this.props.update({imgR:t,imgForm:n?n.attr():{src:""}})}},updatePosition:function(e){var t=this.refs.el,n=min(e.bottom,max(0,e.top-t.offsetHeight))+window.scrollY,o=e.left+t.offsetWidth>window.innerWidth-25?e.width-t.offsetWidth-1:0;t.style.transform="translate("+(e.left+o+window.scrollX)+"px,"+n+"px)"},scroll:function(){var e=this;requestAnimationFrame(function(t){return e.updatePosition(e.props.ce.rect())})},resize:function(){var e=this.props.ce.rect();this.updatePosition(e),this.props.cm&&this.state.CM&&this.state.CM.display.wrapper.css(popOver(e))},blur:function(e){var t=e.relatedTarget;t&&this.refs.el.parentNode.contains(t)||t&&this.props.cm&&(!this.state.CM||this.state.CM.display.wrapper.contains(t))||this.props.update({ce:null,cm:!1})},componentWillUpdate:function(e){e.ce!==this.props.ce&&this.props.ce&&(this.props.ce.removeEventListener("blur",this.blur),window.removeEventListener("scroll",this.scroll),window.removeEventListener("resize",this.resize)),e.cm!==this.props.cm&&this.props.cm&&this.state.CM&&(this.props.ce.innerHTML=this.state.CM.getValue(),this.state.CM.display.wrapper.css({left:""}))},componentDidUpdate:function(e){this.props.ce&&e.ce!==this.props.ce&&(this.updatePosition(this.props.ce.rect()),this.props.ce.addEventListener("blur",this.blur),window.addEventListener("scroll",this.scroll,{passive:!0}),window.addEventListener("resize",this.resize)),e.cm!==this.props.cm&&this.props.cm&&this.state.CM&&(this.state.CM.display.wrapper.css(popOver(this.props.ce.rect())),this.state.CM.setValue(stringify(this.props.ce.cloneNode(!0))),this.props.update({img:null,a:null,aR:null}))},componentDidMount:function(){var e=this;loadScript({src:"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.15.2/codemirror.min.js",onload:function(){e.setState({CM:CodeMirror(document.body,{tabMode:"indent",indentWidthTabs:!0,lineWrapping:!0,tabSize:2,mode:"text/html"})}),loadScript({src:"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.15.2/mode/xml/xml.min.js"})}})},render:function(){var e=this;return v("div",{className:"toolbar"+(this.props.xs?" xs":""),ref:"el",hidden:!this.props.ce,onMouseDown:function(e){return e.preventDefault()}},v("fieldset",{disabled:this.props.cm},this.props.children,v(BlockMenu),v(FontNameMenu),v(FontSizeMenu),v(ColorMenu),v(InlineMenu),v(JustifyMenu),v(ListMenu),v(IconPicker),v(TablePicker,{cfg:cfg.table_picker}),v("button",{onMouseUp:this.newLink,className:this.props.a?"selected":null},v("i",{className:"fa fa-link"})),v("button",{onMouseUp:this.newImage,className:this.props.img?"selected":null},v("i",{className:"fa fa-picture-o"})),v("button",{onMouseUp:function(e){return exec("removeFormat")},title:"Remove format"},v("i",{className:"fa fa-eraser"}))),this.state.CM&&v("button",{onClick:function(t){return e.props.update({cm:!e.props.cm})},title:"View source"},v("i",{className:"fa fa-code"})))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./utils/":11,"./utils/stringifyhtml.js":14,"./widgets/IconPicker.js":17,"./widgets/TablePicker.js":21}],10:[function(require,module,exports){
"use strict";function autoInsertLink(e){if(e.keyCode===spaceKey||e.keyCode===returnKey){var t=sel.getRange().cloneRange();document.activeElement.isContentEditable&&3===t.endContainer.nodeType&&!t.closest("a")&&(expandStart(t),/(https?:\/\/|.tel:|.mailto:)/.test(t.toString())&&(sel.setRange(t),exec("createLink",t.toString().trim()),sel.collapseToEnd()))}}var _require=require("./"),exec=_require.exec,expandStart=_require.expandStart,sel=getSelection();module.exports=function(){document.addEventListener("keydown",autoInsertLink)};var returnKey=13,spaceKey=32;

},{"./":11}],11:[function(require,module,exports){
(function (global){
"use strict";function argMin(){for(var e=0,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var o=1;o<n.length;o++)n[o]<n[e]&&(e=o);return[e,n[e]]}function equals(e,t){for(var n in e)if(e[n]!==t[n])return!1;return!0}function h(e,t){for(var n,r=arguments.length,o=Array(r>2?r-2:0),a=2;a<r;a++)o[a-2]=arguments[a];if(t instanceof Node||"string"==typeof t||Array.isArray(t))return h.apply(void 0,[e,void 0,t].concat(o));var i=document.createElement(e);if(t){for(var l in t)l.startsWith("on")?i[l.toLowerCase()]=t[l]:i.setAttribute("className"==l?"class":"htmlFor"==l?"for":l,t[l]);t.style&&Object.assign(i.style,t.style)}return(n=[]).concat.apply(n,o.map(function(e){return"string"==typeof e?new Text(e):e})).forEach(function(e){return i.appendChild(e)}),i}function tableToMatrix(e){for(var t=Array.from(e.rows[0].cells).reduce(function(e,t){return e+t.colSpan},0),n=Array.from({length:e.rows.length},function(e){return Array(t).fill(null)}),r=0;r<e.rows.length;r++){for(var o=e.rows[r],a=0,i=0;a<o.cells.length;a++){var l=o.cells[a];i=n[r].indexOf(null,i);for(var s=0;s<l.rowSpan;s++){var c;(c=n[r+s]).splice.apply(c,[i,l.colSpan].concat(Array(l.colSpan).fill(l)))}}n[r].tr=o}return n.t=e,n}function matrixToTable(e){for(var t=new DocumentFragment,n=0;n<e.length;n++){var r=e[n].tr||document.createElement("tr");r.innerHTML="";for(var o=0;o<e[n].length;o+=e[n][o].colSpan)isRowSpanned(e,n,o)||r.appendChild(e[n][o]);t.appendChild(r)}return t}function insertNode(e){e.id=TEMPID,exec("insertHTML",e.outerHTML);var t=document.getElementById(TEMPID);return t?(t.removeAttribute("id"),t):console.log("unable to retrieve replaced node")}var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),v=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return!t||React.isValidElement(t)||"string"==typeof t||Array.isArray(t)?React.createElement.apply(React,[e,void 0,t].concat(r)):React.createElement.apply(React,[e,t].concat(r))},max=Math.max,isRowSpanned=function(e,t,n){return t>0&&e[t-1][n]===e[t][n]},sel=getSelection(),exec=function(e,t){return document.execCommand(e,null,t)},TEMPID="temp_id",openDropdown=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"a";return function(t){var n=t.currentTarget,r=function(e){n.parentNode.contains(e.target)||i(!1)},o=function(t){t.target.matches(e)&&i(!1)},a=function(e){27===e.keyCode&&i(!1)},i=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!n.classList.contains("selected");t?(document.addEventListener("mousedown",r),document.addEventListener("keydown",a),e&&n.nextElementSibling.addEventListener("click",o)):(document.removeEventListener("mousedown",r),document.removeEventListener("keydown",a),e&&n.nextElementSibling.removeEventListener("click",o)),n.classList.toggle("selected",t)};i()}};module.exports={dropdown:function(e){var t=e.name,n=void 0===t?"":t,r=e.label,o=void 0===r?n:r,a=e.style,i=e.content,l=e.closeOn,s=void 0===l?"li, li > *, button":l,c=e.onWheel;return v("div",{className:"dropdown "+n,style:a,onWheel:c},v("button",{onMouseDown:openDropdown(s)},o),i)},drophover:function(e){var t=e.name,n=void 0===t?"":t,r=e.label,o=e.content,a=e.closeOn,i=void 0===a?"li, li > *, button":a,l=e.onWheel;return v("div",{className:"dropdown hover "+n,onWheel:l,onMouseUp:function(e){var t=e.target,n=e.currentTarget;t!==n.firstElementChild&&t.matches(i)&&(n.classList.add("hide"),setTimeout(function(e){return n.classList.remove("hide")},1))}},v("button",r),o)},tabs:function(e){var t=e.name,n=e.style,r=e.children,o=void 0===r?[]:r;return v("div",{className:"tabs "+t,style:n},o.map(function(e,n){return v("input",{key:n,type:"radio",defaultChecked:0===n,name:t})}),v("ol",{className:"labels"},o.map(function(e,t){var n=e.label;return v("li",{key:"l"+t,onMouseDown:function(e){e.preventDefault(),e.currentTarget.parentNode.parentNode.children[t].checked=!0}},n)})),v("ol",{className:"contents"},o.map(function(e,t){var n=e.content;return v("li",{key:"c"+t},n)})))},Menu:function(e){var t=e.mount,n=e.render;return React.createClass({shouldComponentUpdate:function(e,t){return!equals(t,this.state)},getInitialState:function(){return{}},componentDidMount:t,render:n})},popOver:function(e){return{left:e.left+window.scrollX+"px",top:e.top+window.scrollY+"px",width:e.width+"px",height:e.height+"px"}},popOver2:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return{left:e.left+window.scrollX+"px",top:e.top+window.scrollY+"px",width:t.right-e.left+"px",height:t.bottom-e.top+"px"}},formatBlock:function(e){var t=document.queryCommandValue("formatblock");return e!==t?exec("formatblock",e):void exec("formatblock","div")},h:h,createFrag:function(e){for(var t=new DocumentFragment;e.firstChild;)t.appendChild(e.firstChild);return t},fill:function(e,t){for(var n=document.createElement(e),r=t.attributes||[],o=Array.isArray(r),a=0,r=o?r:r[Symbol.iterator]();;){var i;if(o){if(a>=r.length)break;i=r[a++]}else{if(a=r.next(),a.done)break;i=a.value}var l=i;n.setAttribute(l.name,l.value)}for(;t.firstChild;)n.appendChild(t.firstChild);return n},v:v,base64:function(e){var t=new FileReader;return t.readAsDataURL(e),new Promise(function(e,n){t.onload=function(t){e(t.target.result)},t.onerror=n})},loadImage:function(e){var t=new Image;return t.src=e,new Promise(function(e,n){t.onerror=t.onabort=n,t.onload=e(t)})},loadScript:function(e){var t=document.createElement("script");Object.assign(t,{async:!0},e),document.head.appendChild(t)},fetchJSON:function(e,t){return fetch(e,t).then(function(e){return e.json()})},tableToMatrix:tableToMatrix,matrixToTable:matrixToTable,argMin:argMin,equals:equals,expandEnd:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/\s$/;;)if(3===e.endContainer.nodeType)if(e.endOffset===e.endContainer.length)e.setEndAfter(e.endContainer);else{if(t.test(e.toString()+e.endContainer.textContent[e.endOffset]))break;e.setEnd(e.endContainer,e.endOffset+1)}else{var n=e.endContainer.childNodes[e.endOffset];if(n)if(3===n.nodeType)e.setEnd(n,0);else{if(!n.firstChild)break;e.setEndBefore(n.firstChild)}else e.setEndAfter(e.endContainer)}},expandStart:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/^(\s|.https?:\/\/|.tel:|.mailto:)/;;)if(3===e.startContainer.nodeType)if(0===e.startOffset)e.setStartBefore(e.startContainer);else{if(t.test(e.startContainer.textContent[e.startOffset-1]+e.toString()))break;e.setStart(e.startContainer,e.startOffset-1)}else{var n=e.startContainer.childNodes[e.startOffset-1];if(n)if(3===n.nodeType)e.setStart(n,n.length);else{if(!n.lastChild)break;e.setStartAfter(n.lastChild)}else e.setStartBefore(e.startContainer)}},exec:exec,execNoCss:function(e,t){exec("styleWithCSS",!1),exec(e,t),exec("styleWithCSS",!0)},createTable:function(e,t){exec("insertHTML",'<table style="width:100%">'+Array.from({length:e+1},function(e,n){return"<tr>"+Array.from({length:t+1},function(e,t){return"<td>   </td>"}).join("")+"</tr>"}).join("")+"</table>")},insertNode:insertNode,insertImage:function(e){var t=sel.getRange().start().closest("a");if(t&&(t.style.float=e.style.float),e=insertNode(e),sel.setRange(sel.selectNode(e)),t){var n=e.closest("a");if(n||(exec("createLink",t.href),n=sel.getRange().start().closest("a")),!n)return console.log("failed to reinsert <a> for <img>, chrome float:right bug");for(var r=n.querySelectorAll(":not(img)"),o=Array.isArray(r),a=0,r=o?r:r[Symbol.iterator]();;){var i;if(o){if(a>=r.length)break;i=r[a++]}else{if(a=r.next(),a.done)break;i=a.value}var l=i;l.remove()}return n.rel=t.rel,n.target=t.target,n.querySelector("img")}return e}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],12:[function(require,module,exports){
"use strict";var _require=require("./"),h=_require.h,bodyR=new Range;bodyR.setStart(document.body,0);var nodeRect=function(e){if(3===e.nodeType){var t=new Range;return t.setStart(e,e.length),t.rect()}return e.rect()},closeButton=h("i",{className:"fa fa-close",onClick:function(e){return close()}}),modal=document.body.appendChild(h("div",{className:"lightbox",onClick:function(e){return e.currentTarget===e.target&&close()}})),close=function(e){modal.innerHTML="",document.removeEventListener("keydown",closeOnEscape)},closeOnEscape=function(e){return 27===e.keyCode&&close()},onLoad=function(e){return closeButton.style.opacity=""},show=function(e){return modal.appendChild(h("div",closeButton.css({opacity:0}),/(.jpg|.png|.gif)$/.test(e)?h("img",{src:e,onLoad:onLoad}):/(.webm|.ogg|.mp4)$/.test(e)?h("video",{src:e,onLoadedData:onLoad,controls:!0,autoplay:!0}):h("iframe",{src:e,onLoad:onLoad,allowFullScreen:!0})))},accepts=function(e){return/(\/embed|(.jpg|.png|.gif|.webm|.ogg|.mp4)$)/.test(e)},listen=function(e){document.body.addEventListener("click",function(e){var t=e.target.closest("a");if(t)if(t.isContentEditable){var o=t.lastChild?nodeRect(t.lastChild):null;(o&&e.clientX>o.right||t.firstChild&&"IMG"===t.firstChild.tagName&&e.target===t)&&("lightbox"===t.target&&accepts(t.href)?show(t.href):new URL(t.href).origin===location.origin&&"_blank"!==t.target?location.href=t.href:window.open(t.href),getSelection().setRange(bodyR))}else"lightbox"===t.target&&accepts(t.href)&&(e.preventDefault(),show(t.href))})};module.exports={show:show,accepts:accepts,listen:listen};

},{"./":11}],13:[function(require,module,exports){
"use strict";function parse(e){for(var t=r.createContextualFragment(e),a=[t.firstChild,t.firstChild.nextSibling,t.lastChild,t.lastChild.previousSibling],l=0;l<a.length;l++){var i=a[l];i&&i.nodeType>3&&i.remove()}var n=document.createElement("div");n.appendChild(t),filterChildren(n);for(var s=n.querySelectorAll('a > img[style*="float"]'),o=Array.isArray(s),g=0,s=o?s:s[Symbol.iterator]();;){var c;if(o){if(g>=s.length)break;c=s[g++]}else{if(g=s.next(),g.done)break;c=g.value}var d=c;d.parentNode.style.float=d.style.float}return n.innerHTML}function filterChildren(e){for(var t=e.childElementCount-1;t>=0;t--){var r=e.children[t],a=tags[r.tagName];if(a&&(r.matches("i.fa, img, a, hr, br")||r.textContent.trim()||r.querySelector("img, i.fa")))if(a.unwrap){filterChildren(r);var l=createFrag(r);e.replaceChild(l,r)}else if(a.replace||"A"===r.tagName&&!r.href){var i=fill(a.replace,r);e.replaceChild(i,r),filterAttributes(i,a),filterChildren(i)}else filterAttributes(r,a),filterChildren(r);else r.remove()}}function filterAttributes(e,t){for(var r=t.attr,a=void 0===r?emptySet:r,l=t.style,i=t.cls,n=e.attributes.length-1;n>=0;n--){var s=e.attributes[n];if("style"==s.name&&l)for(var o=e.style.length-1;o>=0;o--)l.has(e.style[o])||e.style.removeProperty(e.style[o]);else"class"==s.name&&i?some.call(e.classList,function(e){return i.has(e)})||e.removeAttribute("class"):a.has(s.name)||e.removeAttribute(s.name)}}for(var _require=require("./"),exec=_require.exec,createFrag=_require.createFrag,fill=_require.fill,sel=getSelection(),emptySet=new Set,some=Array.prototype.some,tags={},_arr=["PRE","BLOCKQUOTE","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","TBODY","THEAD","TH"],_i=0;_i<_arr.length;_i++){var t=_arr[_i];tags[t]={style:new Set(["text-align"])}}for(var _arr2=["B","STRONG","I","EM","STRIKE","S","U","SUB","SUP","SPAN","A","CODE"],_i2=0;_i2<_arr2.length;_i2++){var _t=_arr2[_i2];tags[_t]={style:new Set(["color","background-color","font-size","float"])}}tags.I.cls=new Set(["fa"]);for(var _arr3=["DIV","MAIN","ASIDE","SECTION","ARTICLE","HEADER","FOOTER"],_i3=0;_i3<_arr3.length;_i3++){var _t2=_arr3[_i3];tags[_t2]={unwrap:!0}}tags.NAV=Object.assign({replace:"P"},tags.P),tags.BUTTON=tags.KBD=Object.assign({replace:"SPAN"},tags.SPAN),tags.IMG={attr:new Set(["src","title","alt"]),style:new Set(["float","width","height","margin"])},tags.TABLE={style:new Set(["text-align","width","height","border-collapse","margin","background-color","border","border-color","border-width","border-style"])},tags.TR={style:new Set(["text-align","height"])},tags.TD={style:new Set(["text-align","width","height","padding","background-color","border","border-color","border-width","border-style"])},tags.BR={},tags.HR={cls:new Set(["line"])},tags.A={attr:new Set(["href","target","rel","title"]),style:new Set(["float","background-color","color","font-size"])};var r=new Range;module.exports=function(){document.addEventListener("paste",function(e){if(e.target.isContentEditable&&"false"!=e.target.dataset.parse){var t=e.clipboardData.getData("text/html");t&&(e.preventDefault(),exec("insertHTML",parse(t)),window.dispatchEvent(new Event("resize")))}})};

},{"./":11}],14:[function(require,module,exports){
"use strict";function stringify(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\t",a=Array.prototype.some.call(e.children,function(e){return!inline.has(e.tagName)});if(!a)return[e.innerHTML.trim()];for(var t=[],l=e.childNodes,i=Array.isArray(l),o=0,l=i?l:l[Symbol.iterator]();;){var n;if(i){if(o>=l.length)break;n=l[o++]}else{if(o=l.next(),o.done)break;n=o.value}var s=n;s.attributes?inline.has(s.tagName)?t.push(s.outerHTML):(t.push.apply(t,["<"+s.tagName.toLowerCase()+stringifyAttr(s)+">"].concat(stringify(s,r).map(function(e){return r+e}))),nonclosing.has(s.tagName)||t.push("</"+s.tagName.toLowerCase()+">")):s.textContent.trim()&&t.push(s.textContent.trim())}return t}var _require=require("./"),createFrag=_require.createFrag,fill=_require.fill,cfg=require("../../config.json"),reFontSizeName=new RegExp("("+Object.keys(cfg.fontsizeName).join("|")+")");module.exports=function(e){for(var r=e.querySelectorAll("b"),a=Array.isArray(r),t=0,r=a?r:r[Symbol.iterator]();;){var l;if(a){if(t>=r.length)break;l=r[t++]}else{if(t=r.next(),t.done)break;l=t.value}var i=l;i.parentNode.replaceChild(fill("strong",i),i)}for(var o=e.querySelectorAll("i:not(.fa)"),n=Array.isArray(o),s=0,o=n?o:o[Symbol.iterator]();;){var f;if(n){if(s>=o.length)break;f=o[s++]}else{if(s=o.next(),s.done)break;f=s.value}var y=f;y.parentNode.replaceChild(fill("em",y),y)}for(var u=e.querySelectorAll("strike"),v=Array.isArray(u),c=0,u=v?u:u[Symbol.iterator]();;){var b;if(v){if(c>=u.length)break;b=u[c++]}else{if(c=u.next(),c.done)break;b=c.value}var A=b;A.parentNode.replaceChild(fill("s",A),A)}for(var g=e.querySelectorAll('[style*="font-size"]'),m=Array.isArray(g),d=0,g=m?g:g[Symbol.iterator]();;){var S;if(m){if(d>=g.length)break;S=g[d++]}else{if(d=g.next(),d.done)break;S=d.value}var h=S;h.style.fontSize=h.style.fontSize.replace(reFontSizeName,function(e){return cfg.fontsizeName[e]+"px"})}for(var p=e.querySelectorAll("[size], [face], [color]"),k=Array.isArray(p),x=0,p=k?p:p[Symbol.iterator]();;){var N;if(k){if(x>=p.length)break;N=p[x++]}else{if(x=p.next(),x.done)break;N=x.value}for(var q=N,C=document.createElement("span"),T=q.attributes,z=Array.isArray(T),E=0,T=z?T:T[Symbol.iterator]();;){var D;if(z){if(E>=T.length)break;D=T[E++]}else{if(E=T.next(),E.done)break;D=E.value}var O=D;"size"==O.name?C.style.fontSize=cfg.fontsizeValue[O.value]+"px":"face"==O.name?C.style.fontFamily=O.value:"color"==O.name?C.style.color=O.value:C.setAttribute(O.name,O.value)}for(;q.firstChild;)C.appendChild(q.firstChild);q.parentNode.replaceChild(C,q)}for(var F=e.querySelectorAll('[style*="color: inherit"]'),R=Array.isArray(F),B=0,F=R?F:F[Symbol.iterator]();;){var L;if(R){if(B>=F.length)break;L=F[B++]}else{if(B=F.next(),B.done)break;L=B.value}var j=L;j.style.color=""}for(var w=e.querySelectorAll('[style*="background-color: inherit"]'),H=Array.isArray(w),I=0,w=H?w:w[Symbol.iterator]();;){var M;if(H){if(I>=w.length)break;M=w[I++]}else{if(I=w.next(),I.done)break;M=I.value}var P=M;P.style.backgroundColor=""}for(var U=e.querySelectorAll('[style=""]'),K=Array.isArray(U),_=0,U=K?U:U[Symbol.iterator]();;){var G;if(K){if(_>=U.length)break;G=U[_++]}else{if(_=U.next(),_.done)break;G=_.value}var Q=G;Q.removeAttribute("style")}for(var V=e.querySelectorAll('[class=""]'),Y=Array.isArray(V),J=0,V=Y?V:V[Symbol.iterator]();;){var W;if(Y){if(J>=V.length)break;W=V[J++]}else{if(J=V.next(),J.done)break;W=J.value}var X=W;X.removeAttribute("class")}for(var Z=e.querySelectorAll("div:not([style]):not([class]), span:not([style]):not([class])"),$=Array.isArray(Z),ee=0,Z=$?Z:Z[Symbol.iterator]();;){var re;if($){if(ee>=Z.length)break;re=Z[ee++]}else{if(ee=Z.next(),ee.done)break;re=ee.value}var ae=re;ae.parentNode.replaceChild(createFrag(ae),ae)}for(var te=e.querySelectorAll('[style*="var("]'),le=Array.isArray(te),ie=0,te=le?te:te[Symbol.iterator]();;){var oe;if(le){if(ie>=te.length)break;oe=te[ie++]}else{if(ie=te.next(),ie.done)break;oe=ie.value}for(var ne=oe,se=ne.style.length-1;se>=0;se--)ne.style[ne.style[se]].includes("var(")&&(ne.style[ne.style[se]]="")}return e.normalize(),stringify(e).join("\n")};var stringifyAttr=function(e){return(e.attributes.length?" ":"")+Array.prototype.map.call(e.attributes,function(e){return e.name+'="'+e.value.replace(/"/g,"")+'"'}).join(" ")},inline=new Set(["IMG","BR","B","STRONG","I","EM","STRIKE","S","U","SUB","SUP","SPAN","A","CODE","KBD","BLOCKQUOTE","PRE","CITE"]),nonclosing=new Set(["P","LI","TD","TH","TR","DT","DD","TBODY","THEAD","TFOOT","HR"]);

},{"../../config.json":2,"./":11}],15:[function(require,module,exports){
"use strict";var max=Math.max;module.exports={addCol:function(r,n,e){for(var o,a=e?r[3]:r[1],t=0;t<n.length;t+=n[t][a].rowSpan){e&&n[t][a]===n[t][a+1]||!e&&n[t][a-1]===n[t][a]?(n[t][a].colSpan+=1,o=n[t][a]):(o=document.createElement("td"),1!==n[t][a].rowSpan&&(o.rowSpan=n[t][a].rowSpan));for(var l=0;l<n[t][a].rowSpan;l++)n[t+l].splice(a+e,0,o)}return e?r.slice():[r[0],r[1]+1,r[2],r[3]+1]},addRow:function(r,n,e){for(var o,a=[],t=e?r[2]:r[0],l=0;l<n[0].length;l+=n[t][l].colSpan){t<n.length-1&&e&&n[t][l]===n[t+1][l]||t>0&&!e&&n[t][l]===n[t-1][l]?(n[t][l].rowSpan+=1,o=n[t][l]):(o=document.createElement("td"),1!==n[t][l].colSpan&&(o.colSpan=n[t][l].colSpan));for(var c=0;c<n[t][l].colSpan;c++)a.push(o)}return n.splice(t+e,0,a),e?r.slice():[r[0]+1,r[1],r[2]+1,r[3]]},delRows:function(r,n){for(var e=r[0];e<=r[2];e++)for(var o=0;o<n[0].length;o+=n[e][o].colSpan)n[e][o].rowSpan=max(1,n[e][o].rowSpan-1);return n.splice(r[0],r[2]-r[0]+1),null},delCols:function(r,n){for(var e=r[1];e<=r[3];e++)for(var o=0;o<n.length;o+=n[o][e].rowSpan)n[o][e].colSpan=max(1,n[o][e].colSpan-1);for(var a=0;a<n.length;a++)n[a].splice(r[1],r[3]-r[1]+1);return null},merge:function(r,n){if(n[r[2]][r[3]]===n[r[0]][r[1]])return this.unmerge(r,n);for(var e=n[r[0]][r[1]],o="",a=0,t=r[0];t<=r[2];t++)for(var l=r[1];l<=r[3];l+=n[t][l].colSpan)n[t][l].parentNode.rowIndex===t&&(o+=n[t][l].innerHTML+" ");for(var c=r[1];c<=r[3];c+=n[r[0]][c].colSpan)a+=parseFloat(n[r[0]][c].style.width);for(var p=r[0];p<=r[2];p++)for(var u=r[1];u<=r[3];u++)p===r[0]&&u===r[1]||(n[p][u]=e);return e.attr({rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1}).innerHTML=o.replace(/(\s*<br>\s*)+/g,"<br>"),r.slice()},unmerge:function(r,n){var e=n[r[0]][r[1]];e.removeAttribute("rowspan"),e.removeAttribute("colspan");for(var o=r[0];o<=r[2];o++)for(var a=r[1];a<=r[3];a++)o===r[0]&&a===r[1]||(n[o][a]=document.createElement("td"));return r.slice()},cellStyle:function(r,n,e){for(var o=r[0];o<=r[2];o++)for(var a=r[1];a<=r[3];a+=n[o][a].colSpan)n[o][a].parentNode.rowIndex===o&&n[o][a].css(e);return r.slice()}};

},{}],16:[function(require,module,exports){
"use strict";function highlightCells(e,t){for(var n=e.t.querySelectorAll("tr > .selected"),r=Array.isArray(n),o=0,n=r?n:n[Symbol.iterator]();;){var a;if(r){if(o>=n.length)break;a=n[o++]}else{if(o=n.next(),o.done)break;a=o.value}var i=a;i.classList.remove("selected")}for(var d=t[0];d<=t[2];d++)for(var l=t[1];l<=t[3];l+=e[d][l].colSpan)e[d][l].classList.add("selected")}function getTableSelection(e,t,n){var r=t.parentNode.rowIndex,o=e[r].indexOf(t);if(t===n)return[r,o,r+t.rowSpan-1,o+t.colSpan-1];var a=n.parentNode.rowIndex,i=e[a].indexOf(n);if(r>a){var d=[a,r];r=d[0],a=d[1]}if(o>i){var l=[i,o];o=l[0],i=l[1]}return expandSelection(e,[r,o,a,i])}function expandSelection(e,t){var n=void 0;do{n=t.slice();for(var r=n[0],o=n[1];o<=n[3];o++)t[0]=min(t[0],e[r][o].parentNode.rowIndex);for(var a=n[0],i=n[1];a<=n[2];a++)t[1]=min(t[1],e[a].indexOf(e[a][i]));for(var d=n[2],l=n[1];l<=n[3];l++)t[2]=max(t[2],e[d][l].parentNode.rowIndex+e[d][l].rowSpan-1);for(var s=n[0],c=n[3];s<=n[2];s++)t[3]=max(t[3],e[s].indexOf(e[s][c])+e[s][c].colSpan-1)}while(t<n||t>n);return t}var _require=require("./"),tableToMatrix=_require.tableToMatrix,min=Math.min,max=Math.max,emit=function(e){return document.dispatchEvent(new CustomEvent("tableselectionchange",{detail:e}))};module.exports=function(){var e={t:null};document.body.addEventListener("mousedown",function(t){if(t.target.isContentEditable){var n=t.target.closest("[contenteditable=true] td, [contenteditable=true] th");if(n){var r=n.closest("table");r!==e.t&&(e=tableToMatrix(r));var o=getTableSelection(e,n,n),a=void 0,i=function(t){emit({type:"end",s:o,M:e,anchor:n,focus:a,target:t.target}),l(),document.addEventListener("keydown",s),document.addEventListener("mousedown",s)},d=function(t){a=t.target.closest("[contenteditable=true] td, [contenteditable=true] th"),a&&r===a.closest("table")&&(o=getTableSelection(e,n,a),highlightCells(e,o))},l=function e(){r.removeEventListener("mouseenter",d,!0),document.removeEventListener("mouseup",i),document.removeEventListener("drop",e),document.removeEventListener("dragend",e)};document.addEventListener("mouseup",i),r.addEventListener("mouseenter",d,!0),document.addEventListener("drop",l),document.addEventListener("dragend",l);var s=function e(){for(var t=r.querySelectorAll("tr > .selected"),n=Array.isArray(t),o=0,t=n?t:t[Symbol.iterator]();;){var a;if(n){if(o>=t.length)break;a=t[o++]}else{if(o=t.next(),o.done)break;a=o.value}var i=a;i.classList.remove("selected")}document.removeEventListener("keydown",e),document.removeEventListener("mousedown",e)}}}})};

},{"./":11}],17:[function(require,module,exports){
"use strict";function getIcons(){var e=document.querySelector("link#fontawesome"),r=localStorage,t=r.faIcons;if(!t&&!e)return[];if(t){var a=JSON.parse(t),n=a.href,o=a.icons;if(!e||n==e)return o}if(e){for(var i=new Set,s=e.sheet.cssRules,c=Array.isArray(s),f=0,s=c?s:s[Symbol.iterator]();;){var l;if(c){if(f>=s.length)break;l=s[f++]}else{if(f=s.next(),f.done)break;l=f.value}var u=l,v=u.selectorText,h=void 0===v?"":v,d=h.match(/\.fa-([\w-]+)::before/);d&&i.add(d[1])}var m=Array.from(i);return localStorage.faIcons=JSON.stringify({href:e.href,icons:m}),m}}var _require=require("../utils/"),v=_require.v,h=_require.h,exec=_require.exec,Menu=_require.Menu,drophover=_require.drophover,sel=getSelection();module.exports=Menu({mount:function(){for(var e=this,r=function(){if(a){if(n>=t.length)return"break";o=t[n++]}else{if(n=t.next(),n.done)return"break";o=n.value}var r=o;e.refs.icons.appendChild(h("i",{className:"fa fa-"+r,title:r,onMouseUp:function(t){return e.insert(r)}}))},t=getIcons(),a=Array.isArray(t),n=0,t=a?t:t[Symbol.iterator]();;){var o,i=r();if("break"===i)break}this.insert=function(r){var t=sel.getRange(),a=t.start().closest(".fa"),n=a?a.cloneNode(!0):h("i"," ");n.className="fa fa-"+r,a&&(t=sel.selectNode(a)),sel.setRange(t),exec("insertHTML",n.outerHTML),e.setState({active:!1})}},render:function(){return drophover({name:"icon-picker",closeOn:"i",label:v("i",{className:"fa fa-fonticons"}),content:v("div",{ref:"icons",className:"scroll"})})}});

},{"../utils/":11}],18:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,StyleWidget=require("./StyleWidget.js"),StyleColorWidget=require("./StyleColorWidget.js"),sides=["border","borderTop","borderRight","borderBottom","borderLeft"];module.exports=React.createClass({shouldComponentUpdate:function(e,t){return Boolean(e.el)&&(this.props.el!==e.el||t.idx!==this.state.idx)},getInitialState:function(){return{idx:0}},render:function(){var e=this,t=this.state.idx,r=sides[t],i=this.props,l=i.el,d=i.tab,o=i.cmd,s=i.palette,a=i.borderWidth,n=i.borderStyle;return v("li",v("span",{onClick:function(r){return e.setState({idx:(t+1)%sides.length})}},r),v(StyleColorWidget,{name:r+"Color",tab:d,cmd:o,el:l,values:s}),v(StyleWidget,{name:r+"Width",tab:d,cmd:o,el:l,values:a}),v(StyleWidget,{name:r+"Style",tab:d,cmd:o,el:l,values:n}))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11,"./StyleColorWidget.js":19,"./StyleWidget.js":20}],19:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,dropdown=_require.dropdown;module.exports=React.createClass({shouldComponentUpdate:function(e){return Boolean(e.el)&&(this.props.el!==e.el||this.props.name!==e.name)},render:function(){var e=this,r=this.props,t=r.name,n=r.tab,o=r.el,a=r.values,s=o?o.style[t]:"gray";return dropdown({name:t+n,label:v("i",{className:"fa fa-tint",style:{color:s}}),content:v("div",{className:"palette"},a.map(function(r,n){return v("button",{key:n,className:r===s?"selected":null,onMouseUp:function(n){var o;return e.props.cmd((o={},o[t]=r===s?"":r,o))},style:{backgroundColor:r}})}))})}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11}],20:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,dropdown=_require.dropdown;module.exports=React.createClass({shouldComponentUpdate:function(e){return Boolean(e.el)&&(this.props.el!==e.el||this.props.name!==e.name)},render:function(){var e=this,r=this.props,t=r.name,o=r.tab,n=void 0===o?"":o,s=r.el,l=r.values,a=s?s.style[t]||getComputedStyle(s)[t]:"";return dropdown({name:t+n,label:this.props.label||a,content:v("ul",{className:"scroll"},l.map(function(r,o){return v("li",{key:o,className:r===a?"selected":null,onMouseUp:function(o){var n;return e.props.cmd((n={},n[t]=r===a?"":r,n))}},r)}))})}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11}],21:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,createTable=_require.createTable;module.exports=React.createClass({shouldComponentUpdate:function(e,t){return t.active!==this.state.active},getInitialState:function(){return{active:!1}},componentWillUnmount:function(){document.removeEventListener("mousedown",this.closeOnOut),document.removeEventListener("keydown",this.closeOnEscape)},componentDidUpdate:function(e,t){t.active!==this.state.active&&(this.state.active?(document.addEventListener("mousedown",this.closeOnOut),document.addEventListener("keydown",this.closeOnEscape)):(document.removeEventListener("mousedown",this.closeOnOut),document.removeEventListener("keydown",this.closeOnEscape),this.update(0,0)))},closeOnOut:function(e){this.refs.el.contains(e.target)||this.setState({active:!1})},closeOnEscape:function(e){27===e.keyCode&&this.setState({active:!1})},componentDidMount:function(){this.update(0,0)},update:function(e,t){for(var s=this.refs,n=s.t,a=s.value,o=0;o<=e;o++){n.rows[o].className="active";for(var c=0;c<=t;c++)n.rows[o].cells[c].className="active selected"}if(n.rows[0].cells[t+1])for(var r=0;r<=e;r++)n.rows[r].cells[t+1].className="";if(n.rows[e+1]){n.rows[e+1].className="";for(var i=0;i<=t;i++)n.rows[e+1].cells[i].className="active";n.rows[e+1].cells[t+1]&&(n.rows[e+1].cells[t+1].className="")}a.textContent=e+1+" x "+(t+1)},render:function(){var e=this;return v("div",{className:"dropdown table-picker",ref:"el"},v("button",{className:this.state.active?"selected":"",onMouseDown:function(t){return e.setState({active:!e.state.active})}},v("i",{className:"fa fa-table"})),v("div",v("table",v("tbody",{ref:"t"},Array.from({length:this.props.cfg.m_max},function(t,s){return v("tr",{key:s},Array.from({length:e.props.cfg.n_max},function(t,n){return v("td",{key:n,onMouseUp:function(t){createTable(s,n),e.setState({active:!1})},onMouseEnter:function(t){return e.update(s,n)}})}))}))),v("div",{className:"table-picker-value",ref:"value"})))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11}]},{},[1,3])(3)
});