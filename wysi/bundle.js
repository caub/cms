(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.wysi = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},sel=getSelection();if(Selection.prototype.getRange=function(){return sel.rangeCount?sel.getRangeAt(0):document.createRange()},Selection.prototype.setRange=function(e){sel.removeAllRanges(),sel.addRange(e)},Selection.prototype.selectNode=function(e){var t=document.createRange();return t.selectNode(e),t},Selection.prototype.selectNodeContents=function(e,t){var n=document.createRange();return n.selectNodeContents(e),void 0!==t&&n.collapse(t),n},document.execCommand("enableInlineTableEditing",null,!1),document.execCommand("enableObjectResizing",null,!1),document.execCommand("styleWithCSS",null,!0),Text.prototype.closest=function(e){return this.parentNode.closest(e)},Text.prototype.matches=function(e){return null},Node.prototype.attr=function(e){if("object"!==("undefined"==typeof e?"undefined":_typeof(e))){for(var t={},n=this.attributes,o=Array.isArray(n),r=0,n=o?n:n[Symbol.iterator]();;){var i;if(o){if(r>=n.length)break;i=n[r++]}else{if(r=n.next(),r.done)break;i=r.value}var a=i;t[a.name]=a.value}return t}for(var s in e)this.setAttribute(s,e[s]);return this},Node.prototype.css=function(e){return Object.assign(this.style,e),this},Node.prototype.index=function(e){return Array.prototype.indexOf.call(this.parentNode.children,this)},Node.prototype.add=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];for(var o=t,r=Array.isArray(o),i=0,o=r?o:o[Symbol.iterator]();;){var a;if(r){if(i>=o.length)break;a=o[i++]}else{if(i=o.next(),i.done)break;a=i.value}var s=a;s instanceof Node?this.appendChild(s):Array.isArray(s)?this.add.apply(this,s):"string"==typeof s&&this.appendChild(document.createTextNode(s))}return this},Node.prototype.on=function(){return this.addEventListener.apply(this,arguments),this},Element.prototype.rect=Element.prototype.getBoundingClientRect,Range.prototype.rect=Range.prototype.getBoundingClientRect,Range.prototype.start=function(){return this.startContainer.childNodes[this.startOffset]||this.startContainer},Range.prototype.closest=function(e){return this.commonAncestorContainer.closest(e)},Document.prototype.closest=function(){return null},Document.prototype.matches=function(){return null},Element.prototype.empty=function(){for(;this.firstChild;)this.removeChild(this.firstChild);return this},Element.prototype.fill=function(e){if(e.attributes)for(var t=e.attributes,n=Array.isArray(t),o=0,t=n?t:t[Symbol.iterator]();;){var r;if(n){if(o>=t.length)break;r=t[o++]}else{if(o=t.next(),o.done)break;r=o.value}var i=r;this.setAttribute(i.name,i.value)}for(;e.firstChild;)this.appendChild(e.firstChild);return this},/edge|chrom/i.test(navigator.userAgent)&&document.body.addEventListener("mousedown",function(e){"IMG"===e.target.tagName&&e.target.isContentEditable&&sel.setRange(sel.selectNode(e.target))}),/firefox\/[0-4]/i.test(navigator.userAgent)&&!function(){var e=function(e){var t=n.getRange();0===t.compareBoundaryPoints(Range.START_TO_START,o)&&0===t.compareBoundaryPoints(Range.END_TO_END,o)||document.dispatchEvent(new CustomEvent("selectionchange",{detail:e})),o=t},t=function(e,t){var n=0;return function(o){var r=this,i=Date.now();i-n>t&&(n=i,setTimeout(function(t){return e.call(r,o)}))}},n=getSelection(),o=document.createRange();document.addEventListener("mousedown",function(t){return setTimeout(function(n){return e(t)})}),document.addEventListener("mouseup",function(t){return setTimeout(function(n){return e(t)})}),document.addEventListener("drop",e),document.addEventListener("mousemove",t(e,50)),document.addEventListener("keydown",t(e,100)),document.addEventListener("keyup",e)}(),/edge/i.test(navigator.userAgent)){console.log("edge fixes");for(var _arr=[NodeList,HTMLCollection,NamedNodeMap,CSSStyleDeclaration,CSSRuleList],_i4=0;_i4<_arr.length;_i4++){var cls=_arr[_i4];cls.prototype[Symbol.iterator]||(cls.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator])}Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t&&!t.matches(e);)t=t.parentNode;return t})}

},{}],2:[function(require,module,exports){
module.exports={

	"inline": ["bold","italic", "underline","strikethrough","superscript","subscript"],

	"justify": ["justifyLeft","justifyCenter","justifyRight","justifyFull"],
	"justifyFa": {
		"justifyLeft":"align-left",
		"justifyCenter":"align-center",
		"justifyRight":"align-right",
		"justifyFull":"align-justify"
	},


	"list": ["insertUnorderedList", "insertOrderedList","indent","outdent"],
	"listFa": {
		"insertUnorderedList":"list-ul",
		"insertOrderedList":"list-ol",
		"outdent":"outdent",
		"indent":"indent"
	},


	"block": ["h1","h2","h3","p", "blockquote","pre"],
	"blockValue": {
		"div":"Normal",
		"p":"Paragraph",
		"h1":"Heading 1",
		"h2":"Heading 2",
		"h3":"Heading 3",
		"pre":"Preformatted",
		"blockquote":"Quote",
		"h4":"Heading 4",
		"h5":"Heading 5",
		"h6":"Heading 6"
	},

	"fontname": ["Times New Roman", "Arial", "Arial Black", "Calibri", "Georgia", "Cursive", "Impact", "Verdana", "Courier New"],
	"fontnameValue": {
		"Arial":"Arial",
		"sans-serif": "Arial",
		"Arial Black": "Arial Black",
		"Calibri": "Calibri",
		"Georgia": "Georgia",
		"serif": "Times New Roman",
		"Times New Roman":"Times New Roman",
		"cursive": "Cursive",
		"Impact": "Impact",
		"Verdana": "Verdana",
		"Courier New": "Courier New"
	},

	"fontsize": ["1", "2", "3", "4", "5", "6", "7"],
	"fontsizeValue": {"1":10, "2":13, "3":16, "4":18, "5":24, "6":32, "7":48},
	"fontsizeName": {"x-small":10, "small":13, "large":18, "x-large":24, "xx-large":32, "-webkit-xxx-large":48},

	"float": ["right","left"],
	"floatFa": {"left": "long-arrow-left", "right": "long-arrow-right"},

	"margin": ["top", "right", "bottom", "left"],
	"marginValues": ["0", "5px", "10px", "20px", "auto"],

	"padding": ["0", "2px", "2px 5px", "5px", "10px", "10px 20px", "20px"],

	"verticalAlign": ["top", "middle", "bottom"],

	"border": ["border", "borderTop", "borderRight",  "borderBottom","borderLeft"],

	"borderStyle": ["double", "solid", "dotted", "dashed", "none", "inset", "outset"],

	"borderWidth": ["thin", "medium", "thick", 0],

	"borderCollapse": ["collapse", "separate"],

	"table_picker": {"m_max":20, "m_min":2, "n_max": 20, "n_min": 2},

	"palette": [
		"rgb(56, 228, 50)",
		"rgb(244, 56, 56)",
		"rgb(44, 120, 244)",

		"rgb(15, 160, 90)",
		"rgb(240, 180, 0)",
		"rgb(85, 170, 238)",

		"rgb(20, 10, 80)",
		"rgb(150, 20, 180)",
		"rgb(230, 230, 220)"
	]

}
},{}],3:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,equals=_require.equals,ImageModal=require("./ImageModal.js"),ImageTools=require("./ImageTools.js"),LinkEdit=require("./LinkEdit.js"),TableTools=require("./TableTools.js"),TableResizer=require("./TableResizer.js"),Toolbar=require("./Toolbar.js"),cfg=require("../config.json"),sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e,t){return!equals(t,this.state)||e.children!==this.props.children},getInitialState:function(){return{a:null,img:null,aForm:{href:"",target:"_blank",rel:""},imgForm:{src:""},aR:null,imgR:null,imgs:[{url:"//searchengineland.com/figz/wp-content/seloads/2015/11/teamwork-meeting-collaboration-ss-1920.jpg",title:"People"},{url:"//thenextweb.com/wp-content/blogs.dir/1/files/2015/06/dots-office-team.jpg",title:"Work"},{url:"https://c4.staticflickr.com/3/2926/14690771011_945f91045a_b.jpg",title:"Cool"},{url:"https://c4.staticflickr.com/7/6117/7029086763_80a4390fda_c.jpg",title:"Castle"}].concat(Array.from({length:9},function(e,t){return{url:"//placekitten.com/600/"+(400+Math.round(100*Math.random()))+"?image="+(t+1)+"#.jpg",title:"Cat "+(t+1)}}))}},update:function(e){this.setState(e)},componentDidMount:function(){require("./utils/pasteparser.js")(),require("./utils/autoinsertlink.js")();var e=require("./utils/lightbox.js");e.listen()},render:function(){var e=this.state,t=e.a,r=e.img,i=e.aForm,a=e.imgForm,l=e.aR,o=e.imgR,s=e.imgs;return v("div",{className:"wysi",ref:"el"},v(ImageTools,{update:this.update,img:r}),v(ImageModal,{update:this.update,imgForm:a,imgR:o,imgs:s}),v(LinkEdit,{update:this.update,aForm:i,aR:l}),v(TableResizer),v(TableTools),v(Toolbar,{ref:"tb",update:this.update,a:t,img:r},this.props.children))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./ImageModal.js":4,"./ImageTools.js":5,"./LinkEdit.js":6,"./TableResizer.js":7,"./TableTools.js":8,"./Toolbar.js":9,"./utils/":11,"./utils/autoinsertlink.js":10,"./utils/lightbox.js":12,"./utils/pasteparser.js":13}],4:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,h=_require.h,insertImage=_require.insertImage,equals=_require.equals,base64=_require.base64,loadImage=_require.loadImage,sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e){return this.props.imgR!==e.imgR||this.props.imgForm!==e.imgForm||this.props.imgs!==e.imgs},componentDidMount:function(){var e=this;this.input=h("input",{type:"file",accept:"image/*",multiple:!0,title:"Click to add your images, or drop them"}).on("change",function(t){return e.addImages(t.target.files)}),this.apply=this.props.apply||function(t,i){var r=e.props,a=r.imgR,s=r.imgForm,n=a.cloneContents().firstChild;n&&"IMG"===n.tagName||(n=new Image),n.attr({src:i.url,title:i.title,style:s.style}),sel.setRange(a),insertImage(n),e.close()},document.addEventListener("dblclick",function(t){document.activeElement.isContentEditable&&t.target.matches("[contenteditable=true] img")&&setTimeout(function(i){return e.props.update({imgR:sel.selectNode(t.target),imgForm:t.target.attr()})})}),window.Aviary&&(this.editor=new Aviary.Feather({apiKey:localStorage.aviaryKey||"fe87002a-3c50-4eb8-be2e-b7cd5ce0efc0",theme:"dark",tools:"all",appendTo:"",onSave:function(t,i){e.editing.url=i,e.props.update({imgs:e.props.imgs.slice()}),e.editor.close()},onError:function(e){console.log(e.message)}}),this.editorImg=document.body.appendChild(h("img",{id:"aviaryUselessImage",hidden:!0,src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})))},componentDidUpdate:function(e){!e.imgR&&this.props.imgR&&document.addEventListener("keydown",this.closeOnEscape)},closeOnEscape:function(e){27===e.keyCode&&this.close(),e.shiftKey&&46===e.keyCode&&this.hovered>=0&&(this.props.imgs.splice(this.hovered,1),this.props.update({imgs:this.props.imgs.slice()}))},edit:function(e,t){e.stopPropagation(),this.editing=t,this.editor.launch({image:this.editorImg.id,url:t.url})},drop:function(e){e.stopPropagation(),e.preventDefault(),this.addImages(e.dataTransfer.files)},dragOver:function(e){e.stopPropagation(),e.preventDefault()},addImages:function(e){var t=this;Promise.all(Array.from(e).filter(function(e){return e.type.startsWith("image")}).map(base64)).then(function(i){t.props.update({imgs:[].concat(i.map(function(t,i){return{url:t,type:"img",time:e[i].lastModified,title:e[i].name.replace(/.\w+$/,"")}}),t.props.imgs)}),t.refs.input.className=""})},addImage:function(e){var t=this,i=this.props.imgs,r=i.findIndex(function(t){return t.url===e});r>=0||loadImage(e).then(function(e){t.props.update({imgs:[{url:e.target.src,title:"",type:"img"}].concat(i)}),t.refs.input.className=""})["catch"](function(e){t.refs.input.className="error",console.log("bad url",e)})},close:function(){var e=arguments.length<=0||void 0===arguments[0]?{target:1,currentTarget:1}:arguments[0];e.currentTarget===e.target&&(this.props.update({imgR:null,img:null}),document.removeEventListener("keydown",this.closeOnEscape))},setForm:function(e){this.props.update({imgForm:Object.assign({},this.props.imgForm,e)})},render:function(){var e=this,t=this.props,i=t.imgForm,r=t.imgs;return v("div",{className:"modal "+(this.props.imgR?"active":""),onClick:this.close,onDrop:this.drop,onDragOver:this.dragOver},v("div",v("i",{className:"fa fa-close",onClick:this.close}),v("div",{className:"scroll"},v("header",v("form",{onSubmit:function(t){return e.addImage(i.src),t.preventDefault(),!1}},v("input",{type:"search",name:"img",value:i.src,ref:"input",placeholder:"Paste an image url",onChange:function(t){return e.setForm({src:t.target.value})},onPaste:function(t){var i=t.clipboardData.getData("text");i?e.addImage(i):t.clipboardData.files.length&&e.addImages(t.clipboardData.files)}}),v("input",{type:"submit",value:"✓"}),v("button",{title:"Click to add your images, or drop them",onClick:function(t){return e.input.click()}},v("i",{className:"fa fa-upload"})))),v("div",{className:"image-picker"},r.map(function(t,a){return v("figure",{key:a,className:t.url===i.src?"selected":null,onMouseEnter:function(t){return e.hovered=a},onMouseLeave:function(t){return e.hovered=void 0}},v("img",{src:t.url,onClick:function(i){return e.apply(i,t)}}),v("div",e.editor&&v("i",{className:"fa fa-magic",onClick:function(i){return e.edit(i,t)}}),v("input",{value:t.title,onChange:function(i){t.title=i.target.value,e.props.update({imgs:r.slice()})}})))})))))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./utils/":11}],5:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,insertImage=_require.insertImage,StyleWidget=require("./widgets/StyleWidget.js"),_require2=require("../config.json"),float=_require2["float"],padding=_require2.padding,max=Math.max,sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e){return this.props.img!==e.img},componentDidMount:function(){var e=this;document.addEventListener("selectionchange",function(t){var s=sel.getRange().start();e.props.update({img:document.activeElement.isContentEditable&&"IMG"===s.tagName&&!sel.isCollapsed&&s})}),window.addEventListener("resize",function(t){e.props.img&&e.refs.el.css(popOver(e.props.img.rect()))})},startResize:function(e){var t=this,s=this.props.img.rect(),i=function n(e){var i=t.props.img.cloneNode(!0);t.props.img.style.width=s.width;var o=insertImage(i);document.removeEventListener("mouseup",n),document.removeEventListener("mousemove",r),t.props.update({img:o})},r=function(i){1===e?t.props.img.style.width=max(25,i.clientX-s.left)+"px":2===e&&(t.props.img.style.width=max(25,s.right-i.clientX)+"px"),t.refs.el.css(popOver(t.props.img.rect()))};document.addEventListener("mouseup",i),document.addEventListener("mousemove",r)},reset:function(e){var t=this.props.img.cloneNode(!0).css({width:""});insertImage(t)},imgStyle:function(e){var t=this,s=this.props.img.cloneNode(!0);s.css(e);var i=insertImage(s);i&&setTimeout(function(e){i.closest("a")&&(i.closest("a").style["float"]=i.style["float"]),t.refs.el.css(popOver(i.rect()))})},render:function(){var e=this,t=this.props.img,s=t?popOver(t.rect()):null;return v("div",{className:"image-tools"+(t&&"right"===t.style["float"]?" right":""),ref:"el",style:s,hidden:!t,onMouseDown:function(e){return e.preventDefault()}},v("div",v(StyleWidget,{name:"float",cmd:this.imgStyle,el:t,values:float,label:v("i",{className:"fa fa-arrows-h"})}),v(StyleWidget,{name:"margin",cmd:this.imgStyle,el:t,values:padding,label:v("i",{className:"fa fa-square-o"})})),v("div",{className:"handle se",onMouseDown:function(t){return e.startResize(1)},onDoubleClick:this.reset}),v("div",{className:"handle ne",onMouseDown:function(t){return e.startResize(1)},onDoubleClick:this.reset}),v("div",{className:"handle sw",onMouseDown:function(t){return e.startResize(2)},onDoubleClick:this.reset}),v("div",{className:"handle nw",onMouseDown:function(t){return e.startResize(2)},onDoubleClick:this.reset}))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./utils/":11,"./widgets/StyleWidget.js":20}],6:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,exec=_require.exec,lightbox=require("./utils/lightbox.js"),sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e){return this.props.aR!==e.aR||this.props.aForm!==e.aForm||this.props.urls!==e.urls},componentDidMount:function(){var e=this;window.addEventListener("resize",function(t){e.props.aR&&e.refs.el.css(popOver(e.props.aR.rect()))}),this.apply=this.props.apply||function(t){t.preventDefault();var a=e.props,n=a.aR,r=a.aForm;sel.setRange(n);var o="IMG"===n.start().tagName&&n.start().style["float"];o&&(n.start().style["float"]="",n.closest("a")&&(n.closest("a").style["float"]="")),exec("createLink",r.href),n=sel.getRange();var s=n.start().closest("a");if(s){s.rel=r.rel,s.target=r.target;var l=s.querySelector("img");l&&o&&(s.style["float"]=l.style["float"]=o)}else console.log("failed to insert <a>, chrome float:right bug");return e.props.update({aR:null}),!1},document.addEventListener("selectionchange",function(t){e.refs.el.contains(document.activeElement)||e.props.update({a:document.activeElement.isContentEditable&&sel.getRange().closest("a"),aR:null})}),document.addEventListener("dblclick",function(t){if(document.activeElement.isContentEditable){var a=t.target.closest("[contenteditable=true] a");a&&setTimeout(function(t){return e.props.update({aR:sel.selectNode(a),aForm:Object.assign({target:"_blank",rel:""},a.attr())})})}})},setForm:function(e,t){this.props.update({aForm:Object.assign({},this.props.aForm,e)}),this.refs.input.focus()},render:function(){var e=this,t=this.props,a=t.aR,n=t.aForm,r=(t.urls,void 0),o=void 0;if(a){var s=a.rect();r=s.top>0?popOver(s):null;var l=s.left<120,i=s.right>window.innerWidth-120;s.width<272&&(l||i)&&(o=l?{right:"auto"}:{left:"auto"})}return v("div",{className:"link-edit",ref:"el",style:r,onMouseDown:function(e){return"INPUT"!==e.target.tagName&&e.preventDefault()}},v("form",{onSubmit:this.apply,style:o},v("div",{className:"row"},v("label",{className:"fa fa-external-link",title:"Open in new window"},v("input",{type:"checkbox",name:"opening",checked:"_blank"===n.target,onChange:function(t){return e.setForm({target:t.target.checked?"_blank":""})}})),v("label",{className:"fa fa-expand",title:"Open in lighbox\nonly images, videos (.png, .jpg, .webm, ...)\nor embed links (youtube, vimeo, maps...)"},v("input",{type:"checkbox",name:"opening",checked:"lightbox"===n.target,onChange:function(t){return e.setForm({target:t.target.checked?"lightbox":""})},disabled:!lightbox.accepts(n.href)})),v("label",{className:"fa fa-ban",title:"No follow"},v("input",{type:"checkbox",checked:n.rel,onChange:function(t){return e.setForm({rel:t.target.checked?"nofollow":""})}})),v("i",{className:"fa fa-remove",title:"Remove link",onClick:function(t){t.preventDefault(),sel.setRange(a),exec("unlink"),e.props.update({aR:null})}})),v("div",{className:"row"},v("input",{type:"search",ref:"input",autoComplete:"on",name:"url",value:n.href,onChange:function(t){return e.setForm({href:t.target.value})}}),v("input",{type:"submit",value:"✓"}))))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./utils/":11,"./utils/lightbox.js":12}],7:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,argMin=_require.argMin,tableToMatrix=_require.tableToMatrix,exec=_require.exec,insertNode=_require.insertNode,min=Math.min,max=Math.max,abs=Math.abs,round=Math.round,sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(){return!1},rowMouseDown:function(){var e=this,t=this.tbl,s=this.td,o=this.iY,r=tableToMatrix(t),i=s.parentNode.rowIndex+(o?s.rowSpan:0),n=void 0;this.i=i,this.refs.row.classList.add("moving");var l=t.rect();n=0===i?[0,l.bottom,l.top]:i===t.rows.length?[l.top,1/0,l.top]:[t.rows[i-1].rect().top,t.rows[i].rect().bottom,l.top];var a=function(t){e.refs.row.style.top=min(max(n[0],t.clientY),n[1])-n[2]+"px"},f=function d(s){document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",d);var o=e.refs.row.offsetTop+4,n=t.cloneNode(!0);if(0===i){var l=parseFloat(t.style.marginTop)||0;0>l+o&&(o=-l),n.style.marginTop=l+o?l+o+"px":"",n.style.height=t.offsetHeight-o+1+"px"}else if(i===r.length)n.style.height=o+"px";else{var f=o-t.rows[i-1].offsetTop,c=t.rows[i].offsetTop+t.rows[i].offsetHeight-o;n.rows[i-1].style.height=round(f/t.offsetHeight*100)+"%",n.rows[i].style.height=round(c/t.offsetHeight*100)+"%"}sel.setRange(sel.selectNode(t)),e.tbl=insertNode(n),e.refs.row.classList.remove("moving"),e.refs.el.css({left:""})};document.addEventListener("mouseup",f),document.addEventListener("mousemove",a)},colMouseDown:function(){var e=this,t=this.tbl,s=this.td,o=this.iX,r=tableToMatrix(t),i=r[s.parentNode.rowIndex].indexOf(s)+(o?s.colSpan:0),n=void 0;this.j=i,this.refs.col.classList.add("moving");var l=t.rect();if(0===i)n=[t.parentNode.rect().left,l.right,l.left];else if(i===r[0].length)n=[l.left,t.parentNode.rect().right,l.left];else{n=[l.left,l.right,l.left];for(var a=0;a<r.length;a++)n[0]=max(n[0],r[a][i-1].rect().left),n[1]=min(n[1],r[a][i].rect().right)}var f=function(t){e.refs.col.style.left=min(max(n[0],t.clientX),n[1])-n[2]+"px"},d=function c(s){document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",c);var o=e.refs.col.offsetLeft+4,n=t.cloneNode(!0),l=tableToMatrix(n);if(0===i){var a=round(100*o/t.parentNode.offsetWidth),d=parseFloat(t.style.marginLeft)||0,h=round(100*t.offsetWidth/t.parentNode.offsetWidth),u=1>a+d?0:a+d,v=h+d-u;n.css({marginLeft:u+"%",width:v+"%"})}else if(i===r[0].length){var m=round(100*o/t.parentNode.offsetWidth),p=parseFloat(t.style.marginLeft)||0;p+m>99&&(m=100-p),n.style.width=m+"%"}else for(var g=0;g<r.length;g++)r[g][i-1]!==r[g][i]&&(l[g][i-1].style.width=round((o-r[g][i-1].offsetLeft)/t.offsetWidth*100)+"%",l[g][i].style.width=round((r[g][i].offsetLeft+r[g][i].offsetWidth-o)/t.offsetWidth*100)+"%");sel.setRange(sel.selectNode(t)),e.tbl=insertNode(n),e.refs.col.classList.remove("moving"),e.refs.el.css({left:""})};document.addEventListener("mouseup",d),document.addEventListener("mousemove",f)},colReset:function(e){var t=this.tbl,s=this.j,o=tableToMatrix(t),r=t.cloneNode(!0),i=tableToMatrix(r);if(0===s){var n=parseFloat(t.style.marginLeft)||0,l=parseFloat(t.style.width)||0;r.style.marginLeft="",l&&(r.style.width=l+n+"%")}else if(s===o[0].length)r.style.width="";else for(var a=0;a<o.length;a++)o[a][s-1]!==o[a][s]&&(i[a][s-1].style.width="",i[a][s].style.width="");sel.setRange(sel.selectNode(t)),insertNode(r),this.refs.el.css({left:""})},rowReset:function(e){var t=this.tbl,s=this.i,o=t.cloneNode(!0);if(0===s){var r=parseFloat(t.style.marginTop)||0,i=parseFloat(t.style.height)||0;o.style.marginTop="",i&&(o.style.height=i+r+"px")}else s===t.rows.length?o.style.height="":(o.rows[s-1].style.height="",o.rows[s].style.height="");sel.setRange(sel.selectNode(t)),insertNode(o),this.refs.el.css({left:""})},componentDidMount:function(){var e=this;document.addEventListener("mousemove",function(t){if(t.target.isContentEditable){var s=t.target.closest("[contenteditable=true] td");if(s){var o=s.closest("table");if(!o)return console.log("DEBUG: no parent table for td?");var r=s.rect(),i=argMin(abs(t.clientX-r.left),abs(t.clientX-r.right)),n=i[0],l=i[1],a=argMin(abs(t.clientY-r.top),abs(t.clientY-r.bottom)),f=a[0],d=a[1];4>l?(e.refs.col.style.left=s.offsetLeft+(n?s.offsetWidth:0)+"px",e.refs.el.css(popOver(o.rect())),Object.assign(e,{td:s,tbl:o,iX:n,iY:f})):4>d&&(e.refs.row.style.top=f?offsetBottom(o.rows[s.parentNode.rowIndex+s.rowSpan-1])+"px":s.parentNode.offsetTop+"px",e.refs.el.css(popOver(o.rect())),Object.assign(e,{td:s,tbl:o,iX:n,iY:f}))}}}),window.addEventListener("resize",function(t){e.refs.el.style.left&&e.refs.el.css({left:""})})},clear:function(){this.tbl.parentNode||this.refs.el.css({left:""})},render:function(){return v("div",{className:"table-resizer",ref:"el",onMouseEnter:this.clear},v("div",{className:"row-resize",ref:"row",onMouseDown:this.rowMouseDown,onDoubleClick:this.rowReset},v("div")),v("div",{className:"col-resize",ref:"col",onMouseDown:this.colMouseDown,onDoubleClick:this.colReset},v("div")))}});var offsetBottom=function(e){return e.offsetTop+e.offsetHeight};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"./utils/":11}],8:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver2=_require.popOver2,tableToMatrix=_require.tableToMatrix,matrixToTable=_require.matrixToTable,dropdown=_require.dropdown,dropdownToggle=_require.dropdownToggle,tabs=_require.tabs,_exec=_require.exec,insertNode=_require.insertNode,StyleWidget=require("./widgets/StyleWidget.js"),StyleColorWidget=require("./widgets/StyleColorWidget.js"),StyleBorderWidget=require("./widgets/StyleBorderWidget.js"),_require2=require("../config.json"),palette=_require2.palette,borderWidth=_require2.borderWidth,borderStyle=_require2.borderStyle,padding=_require2.padding,borderCollapse=_require2.borderCollapse,verticalAlign=_require2.verticalAlign,tableExec=require("./utils/tablecommands.js"),sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(e){return this.state.s!==e.s},getInitialState:function(){return{s:null,M:null}},exec:function(e,t){var r=this.state,l=r.s,a=r.M,i=a.t.cloneNode(!0),n=tableToMatrix(i),o=tableExec[e](l,n,t);if(sel.setRange(sel.selectNode(a.t)),n.length&&n[0].length){var s=matrixToTable(n);i.empty().appendChild(s),n=tableToMatrix(insertNode(i)),this.setState({s:o,M:n})}else _exec("insertHTML","<br>"),this.setState({s:null,M:null})},cellStyle:function(e){this.exec("cellStyle",e)},tableStyle:function(e){var t=this.state.M,r=t.t.cloneNode(!0);r.css(e),sel.setRange(sel.selectNode(t.t));var l=tableToMatrix(insertNode(r));this.setState({s:this.state.s.slice(),M:l})},componentDidMount:function(){var e=this;require("./utils/tableselection.js")(),document.addEventListener("tableselectionchange",function(t){var r=t.detail;"end"===r.type&&setTimeout(function(t){return e.setState({s:r.s,M:r.M})})}),window.addEventListener("resize",function(t){if(e.state.s){var r=e.state,l=r.s,a=r.M,i=a[l[0]][l[1]],n=a[l[2]][l[3]];e.refs.el.css(popOver2(i.rect(),n.rect()))}})},componentDidUpdate:function(e,t){var r=this;!t.s&&this.state.s&&!function(){var e=function l(e){r.setState({s:null,M:null}),document.removeEventListener("keydown",l),document.removeEventListener("mousedown",t)},t=function(t){return!r.refs.el.contains(t.target)&&e()};document.addEventListener("keydown",e),document.addEventListener("mousedown",t)}()},render:function(){var e=this,t=this.state,r=t.s,l=t.M,a=(t.tab,void 0),i=void 0,n=void 0,o=void 0;return r&&(a=l[r[0]][r[1]],i=l[r[2]][r[3]],o=l.t,(sel.isCollapsed||a!==i)&&(n=popOver2(a.rect(),i.rect()))),v("div",{className:"table-tools",ref:"el",style:n},v("div",v("i",{className:"fa fa-caret-left",onClick:function(t){return e.exec("addCol",0)}}),v("i",{className:"fa fa-remove",onClick:function(t){return e.exec("delCols")}}),v("i",{className:"fa fa-caret-right",onClick:function(t){return e.exec("addCol",1)}})),v("div",v("i",{className:"fa fa-caret-up",onClick:function(t){return e.exec("addRow",0)}}),v("i",{className:"fa fa-remove",onClick:function(t){return e.exec("delRows")}}),v("i",{className:"fa fa-caret-down",onClick:function(t){return e.exec("addRow",1)}})),v("div",v("i",{className:"fa fa-compress",onClick:function(t){return e.exec("merge")}}),dropdown({name:"table-style",toggle:dropdownToggle,label:v("i",{className:"fa fa-pencil"}),content:tabs({name:"t-s-tabs",children:[{label:"Cell",content:v("ul",v(StyleBorderWidget,{el:i,cmd:this.cellStyle,tab:1,palette:palette,borderWidth:borderWidth,borderStyle:borderStyle}),v("li",v("span","background"),v(StyleColorWidget,{name:"backgroundColor",tab:1,cmd:this.cellStyle,el:i,values:palette})),v("li",v("span","padding"),v(StyleWidget,{name:"padding",cmd:this.cellStyle,el:i,values:padding})),v("li",v("span","vertical-align"),v(StyleWidget,{name:"verticalAlign",cmd:this.cellStyle,el:i,values:verticalAlign})))},{label:"Table",content:v("ul",v(StyleBorderWidget,{el:o,cmd:this.tableStyle,tab:2,palette:palette,borderWidth:borderWidth,borderStyle:borderStyle}),v("li",v("span","background"),v(StyleColorWidget,{name:"backgroundColor",tab:2,cmd:this.tableStyle,el:o,values:palette})),v("li",v("span","border-collapse"),v(StyleWidget,{name:"borderCollapse",cmd:this.tableStyle,el:o,values:borderCollapse})),v("li",v("span","align"),v("span",v("button",{onMouseUp:function(t){return e.tableStyle({marginLeft:"",marginRight:""})}},v("i",{className:"fa fa-align-left"})),v("button",{onMouseUp:function(t){return e.tableStyle({marginLeft:"auto",marginRight:"auto"})}},v("i",{className:"fa fa-align-center"})),v("button",{onMouseUp:function(t){return e.tableStyle({marginLeft:"auto",marginRight:0})}},v("i",{className:"fa fa-align-right"})))))}]})})))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./utils/":11,"./utils/tablecommands.js":15,"./utils/tableselection.js":16,"./widgets/StyleBorderWidget.js":18,"./widgets/StyleColorWidget.js":19,"./widgets/StyleWidget.js":20}],9:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("./utils/"),v=_require.v,popOver=_require.popOver,exec=_require.exec,execNoCss=_require.execNoCss,expandStart=_require.expandStart,expandEnd=_require.expandEnd,formatBlock=_require.formatBlock,Dropdown=_require.Dropdown,dropdown=_require.dropdown,tabs=_require.tabs,TablePicker=require("./widgets/TablePicker.js"),IconPicker=require("./widgets/IconPicker.js"),stringify=require("./utils/stringifyhtml.js"),cfg=require("../config.json"),max=Math.max,min=Math.min,sign=Math.sign,sel=getSelection(),queryCommandFontName=function(e){var t=document.queryCommandValue("fontname")||"",n=t.split(",")[0].replace(/^["'\s]+|["'\s]+$/g,"");return cfg.fontnameValue[n]||n},queryCommandFontSize=function(e){var t=document.queryCommandValue("fontsize");if(cfg.fontsizeValue.hasOwnProperty(t))return cfg.fontsizeValue[t];var n=sel.getRange().closest("*");return n?parseInt(getComputedStyle(n).fontSize):16},commandStates=function(e){for(var t={},n=e,o=Array.isArray(n),r=0,n=o?n:n[Symbol.iterator]();;){var a;if(o){if(r>=n.length)break;a=n[r++]}else{if(r=n.next(),r.done)break;a=r.value}var s=a;t[s]=document.queryCommandState(s)}return t},BlockDropdown=Dropdown({cmd:formatBlock,update:function(){this.setState({value:document.queryCommandValue("formatblock")})},render:function(){var e=this;return dropdown({name:"formatblock",label:v("i",{className:"fa fa-paragraph"}),content:v("ul",cfg.block.map(function(t,n){return v("li",{key:n,onMouseUp:function(n){return e.cmd(t)},className:t===e.state.value?"selected":null},v(t,cfg.blockValue[t]))}))})}}),FontNameDropdown=Dropdown({update:function(){this.setState({value:queryCommandFontName()})},render:function(){var e=this;return dropdown({name:"fontname",label:v("i",{className:"fa",style:{fontFamily:this.state.value}},this.state.value),content:v("ul",cfg.fontname.map(function(t,n){return v("li",{key:n,onMouseUp:function(n){return e.cmd("fontname",t)},className:t===e.state.value?"selected":null},v("span",{style:{fontFamily:t}},t))}))})}}),FontSizeDropdown=Dropdown({update:function(){this.setState({value:document.queryCommandValue("fontsize")})},render:function(){var e=this;return dropdown({name:"fontsize",label:v("i",{className:"fa"},queryCommandFontSize()),content:v("ul",cfg.fontsize.map(function(t,n){return v("li",{key:n,onMouseUp:function(n){return e.cmd("fontsize",t)},className:t===e.state.value?"selected":null},cfg.fontsizeValue[t])})),onWheel:document.queryCommandSupported("fontSizeDelta")&&function(t){t.preventDefault(),exec("fontsizeDelta",sign(t.deltaY)),e.update(),document.dispatchEvent(new CustomEvent("tableselectionchange",{detail:{type:"start",target:e.refs.el}}))}})}}),ColorDropdown=Dropdown({update:function(){this.setState({forecolor:document.queryCommandValue("forecolor"),backcolor:document.queryCommandValue("backcolor")})},render:function(){var e=this;return dropdown({name:"color",label:v("i",{className:"fa fa-tint",style:{color:this.state.forecolor,backgroundColor:this.state.backcolor}}),content:tabs({name:"color-picker",children:[{label:"Text",content:v("div",{className:"palette"},cfg.palette.map(function(t,n){return v("button",{key:n,className:t===e.state.forecolor?"selected":null,onMouseUp:function(n){return e.cmd("forecolor",t===e.state.forecolor?"inherit":t)},style:{backgroundColor:t}})}))},{label:"Background",content:v("div",{className:"palette"},cfg.palette.map(function(t,n){return v("button",{key:n,className:t===e.state.backcolor?"selected":null,onMouseUp:function(n){return e.cmd("backcolor",t===e.state.backcolor?"inherit":t)},style:{backgroundColor:t}})}))}]})})}}),InlineDropdown=Dropdown({cmd:execNoCss,update:function(){this.setState(commandStates(cfg.inline))},render:function(){var e=this;return dropdown({name:"inline",label:v("i",{className:"fa fa-bold"}),content:v("ul",cfg.inline.map(function(t,n){return v("li",{key:n,onMouseUp:function(n){return e.cmd(t)},className:document.queryCommandState(t)?"selected":null},v("i",{className:"fa fa-"+t}))}))})}}),JustifyDropdown=Dropdown({cmd:function(e,t){exec(e,t),setTimeout(function(e){return window.dispatchEvent(new Event("resize"))})},update:function(){this.setState(commandStates(cfg.justify))},render:function(){var e=this;return dropdown({name:"justify",label:v("i",{className:"fa fa-"+cfg.justifyFa[cfg.justify.find(function(e){return document.queryCommandState(e)})||"justifyLeft"]}),content:v("ul",cfg.justify.map(function(t,n){return v("li",{key:n,onMouseUp:function(n){return e.cmd(t)},className:document.queryCommandState(t)?"selected":null},v("i",{className:"fa fa-"+cfg.justifyFa[t]}))}))})}}),ListDropdown=Dropdown({update:function(){this.setState(commandStates(cfg.list))},render:function(){var e=this;return dropdown({name:"list",label:v("i",{className:"fa fa-list-"+(document.queryCommandState("insertorderedlist")?"ol":"ul")}),content:v("ul",cfg.list.map(function(t,n){return v("li",{key:n,onMouseUp:function(n){return e.cmd(t)},className:document.queryCommandState(t)?"selected":null},v("i",{className:"fa fa-"+cfg.listFa[t]}))}))})}});module.exports=React.createClass({shouldComponentUpdate:function(e,t){return!this.props.a!=!e.a||!this.props.img!=!e.img||e.children!==this.props.children},newLink:function(e){if(!this.refs.fs.disabled){var t={href:"",target:"_blank",rel:""},n=sel.getRange(),o=n.startContainer.closest("a"),r=n.endContainer.closest("a");if("IMG"===n.start().tagName)t.href=n.start().src;else{o&&n.setStartBefore(o),r&&n.setEndAfter(r),expandStart(n),expandEnd(n);var a=n.cloneRange();a.collapse(!1),expandStart(a,/[^.,;!?]/),n.setEnd(a.startContainer,a.startOffset);var s=n.toString().trim().match(/^(https?:\/\/|tel:|mailto:)(.*)/);s&&(t.href=s[2])}(o||r)&&Object.assign(t,(o||r).attr()),this.props.update({aR:n,aForm:t})}},newImage:function(e){if(!this.refs.fs.disabled){var t=sel.getRange(),n=t.cloneContents().querySelector("img");this.props.update({imgR:t,imgForm:n?n.attr():{src:""}})}},componentDidMount:function(){this.cm=window.CodeMirror&&CodeMirror(this.refs.el.parentNode,{tabMode:"indent",indentWidthTabs:!0,lineWrapping:!0,tabSize:2,mode:"text/html"})},show:function(e){var t=this,n=e.target;n.isContentEditable||console.log("warning, non ce"),this.refs.el.hidden=!1,this.updatePosition(n);var o=function s(e){var n=e.currentTarget,o=e.relatedTarget;o&&t.refs.el.parentNode.contains(o)||(t.refs.el.hidden=!0,n.removeEventListener("blur",s),window.removeEventListener("scroll",r),window.removeEventListener("resize",a))},r=function(e){requestAnimationFrame(function(e){return t.updatePosition(n)})},a=function(e){t.updatePosition(n),t.refs.fs.disabled&&t.cm.display.wrapper.css(popOver(n.rect()))};this.refs.fs.disabled&&this.toggleCM(),n.addEventListener("blur",o),window.addEventListener("scroll",r,{passive:!0}),window.addEventListener("resize",a)},updatePosition:function(e){var t=e.rect(),n=this.refs.el,o=min(t.bottom,max(0,t.top-n.offsetHeight))+window.scrollY,r=t.left+n.offsetWidth>window.innerWidth-25?t.width-n.offsetWidth-1:0;n.style.transform="translate("+(t.left+r+window.scrollX)+"px,"+o+"px)"},toggleCM:function(){var e=this.refs.fs;e.disabled?(this.ce.innerHTML=this.cm.getValue(),e.disabled=!1,this.cm.display.wrapper.css({left:""})):document.activeElement.isContentEditable&&(this.ce=document.activeElement,this.cm.display.wrapper.css(popOver(this.ce.rect())),this.cm.setValue(stringify(this.ce.cloneNode(!0))),this.props.update({img:null,a:null,aR:null}),e.disabled=!0)},render:function(){var e=this;return v("div",{className:"toolbar",ref:"el",onMouseDown:function(e){return e.preventDefault()}},v("fieldset",{ref:"fs"},this.props.children,v(BlockDropdown),v(FontNameDropdown),v(FontSizeDropdown),v(ColorDropdown),v(InlineDropdown),v(JustifyDropdown),v(ListDropdown),v(IconPicker),v(TablePicker,{cfg:cfg.table_picker}),v("button",{onMouseUp:this.newLink,className:this.props.a?"selected":null},v("i",{className:"fa fa-link"})),v("button",{onMouseUp:this.newImage,className:this.props.img?"selected":null},v("i",{className:"fa fa-picture-o"})),v("button",{onMouseUp:function(e){return exec("removeFormat")},title:"Remove format"},v("i",{className:"fa fa-eraser"}))),window.CodeMirror&&v("button",{onClick:function(t){return e.toggleCM()},title:"View source"},v("i",{className:"fa fa-code"})))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../config.json":2,"./utils/":11,"./utils/stringifyhtml.js":14,"./widgets/IconPicker.js":17,"./widgets/TablePicker.js":21}],10:[function(require,module,exports){
"use strict";function autoInsertLink(e){if(e.keyCode===spaceKey||e.keyCode===returnKey){var t=sel.getRange();document.activeElement.isContentEditable&&3===t.endContainer.nodeType&&!t.closest("a")&&(expandStart(t),/(https?:\/\/|.tel:|.mailto:)/.test(t.toString())&&(sel.setRange(t),exec("createLink",t.toString().trim()),sel.collapseToEnd()))}}var _require=require("./"),exec=_require.exec,expandStart=_require.expandStart,sel=getSelection();module.exports=function(){document.addEventListener("keydown",autoInsertLink)};var returnKey=13,spaceKey=32;

},{"./":11}],11:[function(require,module,exports){
(function (global){
"use strict";function argMin(){for(var e=0,t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];for(var o=1;o<n.length;o++)n[o]<n[e]&&(e=o);return[e,n[e]]}function equals(e,t){for(var n in e)if(e[n]!==t[n])return!1;return!0}function h(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;n>o;o++)r[o-2]=arguments[o];if(t instanceof Node||"string"==typeof t||Array.isArray(t))return h.apply(void 0,[e,null,t].concat(r));var a=document.createElement(e);return t&&(Object.assign(a,t),t.style&&Object.assign(a.style,t.style),"allowFullScreen"in t&&a.setAttribute("allowFullScreen","")),a.add.apply(a,r),a}function upload(e,t,n,r){var o=new XMLHttpRequest;o.open("post",e),o.send(t),o.onload=n,o.upload&&r&&(o.upload.onprogress=r)}function base64(e){var t=new FileReader;return t.readAsDataURL(e),new Promise(function(e,n){t.onload=function(t){e(t.target.result)},t.onerror=n})}function tableToMatrix(e){for(var t=Array.from(e.rows[0].cells).reduce(function(e,t){return e+t.colSpan},0),n=Array.from({length:e.rows.length},function(e){return Array(t).fill(null)}),r=0;r<e.rows.length;r++){for(var o=e.rows[r],a=0,l=0;a<o.cells.length;a++){var i=o.cells[a];l=n[r].indexOf(null,l);for(var s=0;s<i.rowSpan;s++){var c;(c=n[r+s]).splice.apply(c,[l,i.colSpan].concat(Array(i.colSpan).fill(i)))}}n[r].tr=o}return n.t=e,n}function matrixToTable(e){for(var t=document.createDocumentFragment(),n=0;n<e.length;n++){for(var r=e[n].tr?e[n].tr.empty():document.createElement("tr"),o=0;o<e[n].length;o+=e[n][o].colSpan)isRowSpanned(e,n,o)||r.appendChild(e[n][o]);t.appendChild(r)}return t}function insertNode(e){e.id=TEMPID,exec("insertHTML",e.outerHTML);var t=document.getElementById(TEMPID);return t?(t.removeAttribute("id"),t):console.log("unable to retrieve replaced node")}var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),v=function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;n>o;o++)r[o-2]=arguments[o];return!t||React.isValidElement(t)||"string"==typeof t||Array.isArray(t)?React.createElement.apply(React,[e,void 0,t].concat(r)):React.createElement.apply(React,[e,t].concat(r))},max=Math.max,isRowSpanned=function(e,t,n){return t>0&&e[t-1][n]===e[t][n]},sel=getSelection(),exec=function(e,t){return document.execCommand(e,null,t)},TEMPID="temp_id",dropdownToggle=function(e){var t=e.currentTarget,n=function(e){t.parentNode.contains(e.target)||o(!1)},r=function(e){e.keyCode===escapeKey&&o(!1)},o=function(){var e=arguments.length<=0||void 0===arguments[0]?!t.classList.contains("selected"):arguments[0];e?(document.addEventListener("mousedown",n),document.addEventListener("keydown",r)):(document.removeEventListener("mousedown",n),document.removeEventListener("keydown",r)),t.classList.toggle("selected",e)};o()},escapeKey=27;module.exports={dropdownToggle:dropdownToggle,dropdown:function(e){var t=e.name,n=void 0===t?"":t,r=e.label,o=void 0===r?n:r,a=e.ref,l=void 0===a?"el":a,i=e.style,s=e.content,c=e.onMouseDown,d=void 0===c?dropdownToggle:c,u=e.onWheel;return v("div",{className:"dropdown "+n,ref:l,style:i,onWheel:u},v("button",{onMouseDown:d},o),s)},tabs:function(e){var t=e.name,n=e.style,r=e.children,o=void 0===r?[]:r;return v("div",{className:"tabs "+t,style:n},o.map(function(e,n){return v("input",{key:n,type:"radio",defaultChecked:0===n,name:t})}),v("ol",{className:"labels"},o.map(function(e,t){var n=e.label;return v("li",{key:"l"+t,onMouseDown:function(e){e.preventDefault(),e.currentTarget.parentNode.parentNode.children[t].checked=!0}},n)})),v("ol",{className:"contents"},o.map(function(e,t){var n=e.content;return v("li",{key:"c"+t},n)})))},Dropdown:function(e){var t=e.cmd,n=void 0===t?exec:t,r=e.update,o=e.render;return React.createClass({shouldComponentUpdate:function(e,t){return!equals(t,this.state)},getInitialState:function(){return{}},toggle:dropdownToggle,update:r,componentDidMount:function(){var e=this;document.addEventListener("selectionchange",function(t){return document.activeElement.isContentEditable&&e.update()})},componentWillUnmount:function(){console.log("unmounting dropdown")},cmd:function(e,t){n(e,t),this.update(),this.toggle({currentTarget:this.refs.el.firstChild})},render:o})},popOver:function(e){return{left:e.left+window.scrollX+"px",top:e.top+window.scrollY+"px",width:e.width+"px",height:e.height+"px"}},popOver2:function(e){var t=arguments.length<=1||void 0===arguments[1]?e:arguments[1];return{left:e.left+window.scrollX+"px",top:e.top+window.scrollY+"px",width:t.right-e.left+"px",height:t.bottom-e.top+"px"}},formatBlock:function(e){var t=document.queryCommandValue("formatblock");return e!==t?exec("formatblock",e):void exec("formatblock","div")},h:h,createFrag:function(e){for(var t=document.createDocumentFragment();e.firstChild;)t.appendChild(e.firstChild);return t},v:v,upload:upload,base64:base64,loadImage:function(e){var t=new Image;return t.src=e,new Promise(function(e,n){t.onerror=t.onabort=n,t.onload=e})},fetchJSON:function(e,t){return fetch(e,t).then(function(e){return e.json()})},tableToMatrix:tableToMatrix,matrixToTable:matrixToTable,argMin:argMin,equals:equals,expandEnd:function(e){for(var t=arguments.length<=1||void 0===arguments[1]?/\s$/:arguments[1];;)if(3===e.endContainer.nodeType)if(e.endOffset===e.endContainer.length)e.setEndAfter(e.endContainer);else{if(t.test(e.toString()+e.endContainer.textContent[e.endOffset]))break;e.setEnd(e.endContainer,e.endOffset+1)}else{var n=e.endContainer.childNodes[e.endOffset];if(n)if(3===n.nodeType)e.setEnd(n,0);else{if(!n.firstChild)break;e.setEndBefore(n.firstChild)}else e.setEndAfter(e.endContainer)}},expandStart:function(e){for(var t=arguments.length<=1||void 0===arguments[1]?/^(\s|.https?:\/\/|.tel:|.mailto:)/:arguments[1];;)if(3===e.startContainer.nodeType)if(0===e.startOffset)e.setStartBefore(e.startContainer);else{if(t.test(e.startContainer.textContent[e.startOffset-1]+e.toString()))break;e.setStart(e.startContainer,e.startOffset-1)}else{var n=e.startContainer.childNodes[e.startOffset-1];if(n)if(3===n.nodeType)e.setStart(n,n.length);else{if(!n.lastChild)break;e.setStartAfter(n.lastChild)}else e.setStartBefore(e.startContainer)}},exec:exec,execNoCss:function(e,t){exec("styleWithCSS",!1),exec(e,t),exec("styleWithCSS",!0)},createTable:function(e,t){exec("insertHTML",'<table style="width:100%">'+Array.from({length:e+1},function(e,n){return"<tr>"+Array.from({length:t+1},function(e,t){return"<td>   </td>"}).join("")+"</tr>"}).join("")+"</table>")},insertNode:insertNode,insertImage:function(e){var t=sel.getRange().start().closest("a");if(t&&(t.style["float"]=e.style["float"]),e=insertNode(e),sel.setRange(sel.selectNode(e)),t){var n=e.closest("a");return n||(exec("createLink",t.href),n=sel.getRange().start().closest("a")),n?(n.rel=t.rel,n.target=t.target,n.querySelector("img")):console.log("failed to reinsert <a> for <img>, chrome float:right bug",e)}return e}};

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],12:[function(require,module,exports){
"use strict";var _require=require("./"),h=_require.h,bodyR=document.createRange(),aR=document.createRange();bodyR.setStart(document.body,0);var endRange=function(e){var t=document.createRange();return t.setStart(e,e.length),t},modal=document.body.appendChild(h("div",{className:"lightbox"})),close=function(e){modal.empty(),document.removeEventListener("keydown",closeOnEscape)},closeOnEscape=function(e){return 27===e.keyCode&&close()},show=function(e){modal.add(h("div",h("i",{className:"fa fa-close"}).on("click",function(e){return close()}),/(.jpg|.png|.gif)$/.test(e)?h("img",{src:e}):/(.webm|.ogg|.mp4)$/.test(e)?h("video",{src:e,controls:!0,autoplay:!0}):h("iframe",{src:e,allowFullScreen:!0}))).on("click",function(e){return e.currentTarget===e.target&&close()}),document.addEventListener("keydown",closeOnEscape)},accepts=function(e){return/(\/embed|(.jpg|.png|.gif|.webm|.ogg|.mp4)$)/.test(e)},listen=function(e){document.body.addEventListener("click",function(e){var t=e.target.closest("a");if(t)if(t.isContentEditable){var n=t.lastChild&&3===t.lastChild.nodeType?endRange(t.lastChild).rect():null;(n&&e.clientX>n.right||t.firstChild&&"IMG"===t.firstChild.tagName&&e.target===t)&&("lightbox"===t.target&&accepts(t.href)?show(t.href):new URL(t.href).origin===location.origin&&"_blank"!==t.target?location.href=t.href:window.open(t.href),getSelection().setRange(bodyR))}else"lightbox"===t.target&&accepts(t.href)&&(e.preventDefault(),show(t.href))})};module.exports={show:show,accepts:accepts,listen:listen};

},{"./":11}],13:[function(require,module,exports){
"use strict";function parse(e){for(var t=r.createContextualFragment(e),a=[t.firstChild,t.firstChild.nextSibling,t.lastChild,t.lastChild.previousSibling],s=0;s<a.length;s++){var i=a[s];i&&i.nodeType>3&&i.remove()}var l=document.createElement("div");return l.appendChild(t),filterChildren(l),l.innerHTML}function filterChildren(e){for(var t=e.firstElementChild;t;){var r=t.nextElementSibling,a=tags[t.tagName];if(a&&(keepEmptyTags[t.tagName]||t.textContent.trim()||t.querySelector("i.fa")))if(a.u){filterChildren(t);var s=createFrag(t);t.parentNode.replaceChild(s,t)}else if(a.r||"A"===t.tagName&&!t.href){var i=document.createElement(a.r||"SPAN").fill(t);t.parentNode.replaceChild(i,t),filterAttributes(i,a),filterChildren(i)}else filterAttributes(t,a),filterChildren(t);else t.remove();t=r}}function filterAttributes(e,t){for(var r=0;r<e.attributes.length;){var a=e.attributes[r];t.a.test(a.name)?r++:e.removeAttribute(a.name)}if(e.hasAttribute("style")){for(var s={},i=0;i<e.style.length;i++){var l=e.style[i];t.s.test(l)&&(s[l]=e.style[l])}e.removeAttribute("style"),e.css(s)}if(e.hasAttribute("class")){var n,o=Array.prototype.filter.call(e.classList,function(e){return t.c.test(e)});e.removeAttribute("class"),(n=e.classList).add.apply(n,o)}}for(var _require=require("./"),exec=_require.exec,createFrag=_require.createFrag,sel=getSelection(),tags={},_arr=["PRE","BLOCKQUOTE","P","H1","H2","H3","H4","H5","H6","UL","OL","LI","TBODY","THEAD","TH"],_i=0;_i<_arr.length;_i++){var t=_arr[_i];tags[t]={a:/^style|^class|^id/,s:/^text-align/,c:/test/}}for(var _arr2=["B","STRONG","I","EM","STRIKE","DEL","U","SUB","SUP","SPAN","A","CODE"],_i2=0;_i2<_arr2.length;_i2++){var _t=_arr2[_i2];tags[_t]={a:/^style|^class/,s:/^color|^background-color|^font|^float/,c:/^fa/}}for(var _arr3=["DIV","MAIN","ASIDE","SECTION","ARTICLE","HEADER","FOOTER"],_i3=0;_i3<_arr3.length;_i3++){var _t2=_arr3[_i3];tags[_t2]={u:!0}}tags.NAV=Object.assign({r:"P"},tags.P),tags.BUTTON=tags.KBD=Object.assign({r:"SPAN"},tags.SPAN),tags.IMG={a:/^style|^class|^src/,s:/^float|^width|^height|^margin/,c:/^fa/},tags.TABLE={a:/^style|^class|^id/,s:/^text-align|^width|^height|^border-collapse|^margin|^background-color|^border/,c:/res/},tags.TR={a:/^style|^class/,s:/^text-align|^height/,c:/test/},tags.TD={a:/^style/,s:/^text-align|^width|^height|^padding|^background-color|^border/},tags.BR={a:/.^/},tags.HR={a:/^class/,c:/^line|^fa/},tags.A={a:/^style|^class|^href|^target|^rel/,s:/^background-color|^color|^font/,c:/^fa/};var r=document.createRange();module.exports=function(){document.addEventListener("paste",function(e){if(e.target.isContentEditable){if(window.disablePasteParser)return console.log("paste parser disabled");var t=e.clipboardData.getData("text/html");t&&(e.preventDefault(),exec("insertHTML",parse(t)))}})};var keepEmptyTags={I:!0,IMG:!0,A:!0,HR:!0,BR:!0};

},{"./":11}],14:[function(require,module,exports){
"use strict";function stringify(e){var r=arguments.length<=1||void 0===arguments[1]?"	":arguments[1],t=Array.prototype.some.call(e.children,function(e){return!inline.has(e.tagName)});if(!t)return[e.innerHTML.trim()];for(var a=[],l=e.childNodes,i=Array.isArray(l),o=0,l=i?l:l[Symbol.iterator]();;){var n;if(i){if(o>=l.length)break;n=l[o++]}else{if(o=l.next(),o.done)break;n=o.value}var s=n;s.attributes?inline.has(s.tagName)?a.push(s.outerHTML):(a.push.apply(a,["<"+s.tagName.toLowerCase()+stringifyAttr(s)+">"].concat(stringify(s,r).map(function(e){return r+e}))),nonclosing.has(s.tagName)||a.push("</"+s.tagName.toLowerCase()+">")):s.textContent.trim()&&a.push(s.textContent.trim())}return a}var _require=require("./"),h=_require.h,createFrag=_require.createFrag,cfg=require("../../config.json"),reFontSizeName=new RegExp("("+Object.keys(cfg.fontsizeName).join("|")+")");module.exports=function(e){for(var r=e.querySelectorAll("b"),t=Array.isArray(r),a=0,r=t?r:r[Symbol.iterator]();;){var l;if(t){if(a>=r.length)break;l=r[a++]}else{if(a=r.next(),a.done)break;l=a.value}var i=l;i.parentNode.replaceChild(h("strong").fill(i),i)}for(var o=e.querySelectorAll("i:not(.fa)"),n=Array.isArray(o),s=0,o=n?o:o[Symbol.iterator]();;){var f;if(n){if(s>=o.length)break;f=o[s++]}else{if(s=o.next(),s.done)break;f=s.value}var y=f;y.parentNode.replaceChild(h("em").fill(y),y)}for(var u=e.querySelectorAll("strike"),v=Array.isArray(u),c=0,u=v?u:u[Symbol.iterator]();;){var b;if(v){if(c>=u.length)break;b=u[c++]}else{if(c=u.next(),c.done)break;b=c.value}var A=b;A.parentNode.replaceChild(h("del").fill(A),A)}for(var g=e.querySelectorAll('[style*="font-size"]'),S=Array.isArray(g),d=0,g=S?g:g[Symbol.iterator]();;){var m;if(S){if(d>=g.length)break;m=g[d++]}else{if(d=g.next(),d.done)break;m=d.value}var p=m;p.style.fontSize=p.style.fontSize.replace(reFontSizeName,function(e){return cfg.fontsizeName[e]})}for(var k=e.querySelectorAll("font[size]"),N=Array.isArray(k),q=0,k=N?k:k[Symbol.iterator]();;){var x;if(N){if(q>=k.length)break;x=k[q++]}else{if(q=k.next(),q.done)break;x=q.value}var T=x;T.attributes.length>2&&console.log("warning, skipped other attrs on ff",T);var C=h("span",{style:{fontSize:cfg.fontsizeValue[T.size]}});T.parentNode.replaceChild(C.fill(T),T)}for(var z=e.querySelectorAll('[style*="color: inherit"]'),D=Array.isArray(z),E=0,z=D?z:z[Symbol.iterator]();;){var O;if(D){if(E>=z.length)break;O=z[E++]}else{if(E=z.next(),E.done)break;O=E.value}var L=O;L.style.color=""}for(var R=e.querySelectorAll('[style*="background-color: inherit"]'),w=Array.isArray(R),B=0,R=w?R:R[Symbol.iterator]();;){var F;if(w){if(B>=R.length)break;F=R[B++]}else{if(B=R.next(),B.done)break;F=B.value}var j=F;j.style.backgroundColor=""}for(var H=e.querySelectorAll('[style=""]'),I=Array.isArray(H),M=0,H=I?H:H[Symbol.iterator]();;){var P;if(I){if(M>=H.length)break;P=H[M++]}else{if(M=H.next(),M.done)break;P=M.value}var U=P;U.removeAttribute("style")}for(var K=e.querySelectorAll('[class=""]'),_=Array.isArray(K),G=0,K=_?K:K[Symbol.iterator]();;){var Q;if(_){if(G>=K.length)break;Q=K[G++]}else{if(G=K.next(),G.done)break;Q=G.value}var V=Q;V.removeAttribute("class")}for(var Y=e.querySelectorAll("div:not([style]):not([class]), span:not([style]):not([class])"),J=Array.isArray(Y),W=0,Y=J?Y:Y[Symbol.iterator]();;){var X;if(J){if(W>=Y.length)break;X=Y[W++]}else{if(W=Y.next(),W.done)break;X=W.value}var Z=X;Z.parentNode.replaceChild(createFrag(Z),Z)}for(var $=e.querySelectorAll('[style*="var("]'),ee=Array.isArray($),re=0,$=ee?$:$[Symbol.iterator]();;){var te;if(ee){if(re>=$.length)break;te=$[re++]}else{if(re=$.next(),re.done)break;te=re.value}for(var ae=te,le=ae.style.length-1;le>=0;le--)ae.style[ae.style[le]].includes("var(")&&(ae.style[ae.style[le]]="")}return e.normalize(),stringify(e).join("\n")};var stringifyAttr=function(e){return(e.attributes.length?" ":"")+Array.prototype.map.call(e.attributes,function(e){return e.name+'="'+e.value.replace(/"/g,"")+'"'}).join(" ")},inline=new Set(["IMG","BR","B","STRONG","I","EM","STRIKE","DEL","U","SUB","SUP","SPAN","A","CODE","KBD","BLOCKQUOTE","PRE","CITE"]),nonclosing=new Set(["P","LI","TD","TH","TR","DT","DD","TBODY","THEAD","TFOOT","HR"]);

},{"../../config.json":2,"./":11}],15:[function(require,module,exports){
"use strict";var max=Math.max;module.exports={addCol:function(r,n,e){for(var o,a=e?r[3]:r[1],t=0;t<n.length;t+=n[t][a].rowSpan){e&&n[t][a]===n[t][a+1]||!e&&n[t][a-1]===n[t][a]?(n[t][a].colSpan+=1,o=n[t][a]):(o=document.createElement("td"),1!==n[t][a].rowSpan&&(o.rowSpan=n[t][a].rowSpan));for(var l=0;l<n[t][a].rowSpan;l++)n[t+l].splice(a+e,0,o)}return e?r.slice():[r[0],r[1]+1,r[2],r[3]+1]},addRow:function(r,n,e){for(var o,a=[],t=e?r[2]:r[0],l=0;l<n[0].length;l+=n[t][l].colSpan){t<n.length-1&&e&&n[t][l]===n[t+1][l]||t>0&&!e&&n[t][l]===n[t-1][l]?(n[t][l].rowSpan+=1,o=n[t][l]):(o=document.createElement("td"),1!==n[t][l].colSpan&&(o.colSpan=n[t][l].colSpan));for(var c=0;c<n[t][l].colSpan;c++)a.push(o)}return n.splice(t+e,0,a),e?r.slice():[r[0]+1,r[1],r[2]+1,r[3]]},delRows:function(r,n){for(var e=r[0];e<=r[2];e++)for(var o=0;o<n[0].length;o+=n[e][o].colSpan)n[e][o].rowSpan=max(1,n[e][o].rowSpan-1);return n.splice(r[0],r[2]-r[0]+1),null},delCols:function(r,n){for(var e=r[1];e<=r[3];e++)for(var o=0;o<n.length;o+=n[o][e].rowSpan)n[o][e].colSpan=max(1,n[o][e].colSpan-1);for(var a=0;a<n.length;a++)n[a].splice(r[1],r[3]-r[1]+1);return null},merge:function(r,n){if(n[r[2]][r[3]]===n[r[0]][r[1]])return this.unmerge(r,n);for(var e=n[r[0]][r[1]],o="",a=0,t=r[0];t<=r[2];t++)for(var l=r[1];l<=r[3];l+=n[t][l].colSpan)n[t][l].parentNode.rowIndex===t&&(o+=n[t][l].innerHTML+" ");for(var c=r[1];c<=r[3];c+=n[r[0]][c].colSpan)a+=parseFloat(n[r[0]][c].style.width);for(var p=r[0];p<=r[2];p++)for(var s=r[1];s<=r[3];s++)p===r[0]&&s===r[1]||(n[p][s]=e);return e.attr({rowspan:r[2]-r[0]+1,colspan:r[3]-r[1]+1}).innerHTML=o.replace(/(\s*<br>\s*)+/g,"<br>"),r.slice()},unmerge:function(r,n){var e=n[r[0]][r[1]];e.style.width.endsWith("%")?parseFloat(e.style.width)/e.colSpan:null;e.removeAttribute("rowspan"),e.removeAttribute("colspan");for(var o=r[0];o<=r[2];o++)for(var a=r[1];a<=r[3];a++)o===r[0]&&a===r[1]||(n[o][a]=document.createElement("td"));return r.slice()},cellStyle:function(r,n,e){for(var o=r[0];o<=r[2];o++)for(var a=r[1];a<=r[3];a+=n[o][a].colSpan)n[o][a].parentNode.rowIndex===o&&n[o][a].css(e);return r.slice()}};

},{}],16:[function(require,module,exports){
"use strict";function highlightCells(e,t){for(var n=e.t.querySelectorAll("tr > .selected"),r=Array.isArray(n),o=0,n=r?n:n[Symbol.iterator]();;){var a;if(r){if(o>=n.length)break;a=n[o++]}else{if(o=n.next(),o.done)break;a=o.value}var i=a;i.classList.remove("selected")}for(var d=t[0];d<=t[2];d++)for(var l=t[1];l<=t[3];l+=e[d][l].colSpan)e[d][l].classList.add("selected")}function getTableSelection(e,t,n){var r=t.parentNode.rowIndex,o=e[r].indexOf(t);if(t===n)return[r,o,r+t.rowSpan-1,o+t.colSpan-1];var a=n.parentNode.rowIndex,i=e[a].indexOf(n);if(r>a){var d=[a,r];r=d[0],a=d[1]}if(o>i){var l=[i,o];o=l[0],i=l[1]}return expandSelection(e,[r,o,a,i])}function expandSelection(e,t){var n=void 0;do{n=t.slice();for(var r=n[0],o=n[1];o<=n[3];o++)t[0]=min(t[0],e[r][o].parentNode.rowIndex);for(var a=n[0],i=n[1];a<=n[2];a++)t[1]=min(t[1],e[a].indexOf(e[a][i]));for(var d=n[2],l=n[1];l<=n[3];l++)t[2]=max(t[2],e[d][l].parentNode.rowIndex+e[d][l].rowSpan-1);for(var s=n[0],c=n[3];s<=n[2];s++)t[3]=max(t[3],e[s].indexOf(e[s][c])+e[s][c].colSpan-1)}while(n>t||t>n);return t}var _require=require("./"),tableToMatrix=_require.tableToMatrix,min=Math.min,max=Math.max,emit=function(e){return document.dispatchEvent(new CustomEvent("tableselectionchange",{detail:e}))};module.exports=function(){var e={t:null};document.body.addEventListener("mousedown",function(t){if(t.target.isContentEditable){var n=t.target.closest("[contenteditable=true] td, [contenteditable=true] th");if(n){var r=n.closest("table");r!==e.t&&(e=tableToMatrix(r));var o=getTableSelection(e,n,n),a=void 0,i=function(t){emit({type:"end",s:o,M:e,anchor:n,focus:a,target:t.target}),l(),document.addEventListener("keydown",s),document.addEventListener("mousedown",s)},d=function(t){a=t.target.closest("[contenteditable=true] td, [contenteditable=true] th"),a&&r===a.closest("table")&&(o=getTableSelection(e,n,a),highlightCells(e,o))},l=function c(){r.removeEventListener("mouseenter",d,!0),document.removeEventListener("mouseup",i),document.removeEventListener("drop",c),document.removeEventListener("dragend",c)};document.addEventListener("mouseup",i),r.addEventListener("mouseenter",d,!0),document.addEventListener("drop",l),document.addEventListener("dragend",l);var s=function u(){for(var e=r.querySelectorAll("tr > .selected"),t=Array.isArray(e),n=0,e=t?e:e[Symbol.iterator]();;){var o;if(t){if(n>=e.length)break;o=e[n++]}else{if(n=e.next(),n.done)break;o=n.value}var a=o;a.classList.remove("selected")}document.removeEventListener("keydown",u),document.removeEventListener("mousedown",u)}}}})};

},{"./":11}],17:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,h=_require.h,exec=_require.exec,dropdown=_require.dropdown,dropdownToggle=_require.dropdownToggle,sel=getSelection();module.exports=React.createClass({shouldComponentUpdate:function(){return!1},toggle:dropdownToggle,componentDidMount:function(){var e=this,t=document.querySelector("link#fontawesome");if(t){var n=function(){if(o){if(s>=r.length)return"break";i=r[s++]}else{if(s=r.next(),s.done)return"break";i=s.value}var t=i,n=t.selectorText;if(!n)return"continue";var a=n.match(/\.fa-([\w-]+)::before/);a&&e.refs.icons.appendChild(h("i",{className:"fa fa-"+a[1],title:a[1]}).on("mouseup",function(t){return e.insert(a[1])}))};e:for(var r=t.sheet.cssRules,o=Array.isArray(r),s=0,r=o?r:r[Symbol.iterator]();;){var i,a=n();switch(a){case"break":break e;case"continue":continue}}document.body.addEventListener("click",function(t){t.target.matches(".fa")&&t.target.isContentEditable&&(sel.setRange(sel.selectNode(t.target)),e.toggle({currentTarget:e.refs.el.firstChild}))})}},insert:function(e){var t=sel.getRange(),n=t.start().closest(".fa"),r=n?n.cloneNode(!0):h("i"," ");if(r.className="fa fa-"+e,n&&(t=sel.selectNode(n)),3===t.endContainer.nodeType){for(;t.endOffset<t.endContainer.length&&!/[\S\n]/.test(t.endContainer.textContent[t.endOffset]);)t.setEnd(t.endContainer,t.endOffset+1);t.endOffset===t.endContainer.length&&t.setEndAfter(t.endContainer)}for(;t.endContainer.childNodes[t.endOffset]&&!/[\S\n]/.test(t.endContainer.childNodes[t.endOffset].textContent);)t.setEndAfter(t.endContainer.childNodes[t.endOffset]);sel.setRange(t),exec("insertHTML",r.outerHTML+" "),this.toggle({currentTarget:this.refs.el.firstChild})},render:function(){return dropdown({name:"icon-picker",label:v("i",{className:"fa fa-fonticons"}),content:v("div",{ref:"icons",className:"scroll"})})}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11}],18:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,StyleWidget=require("./StyleWidget.js"),StyleColorWidget=require("./StyleColorWidget.js"),sides=["border","borderTop","borderRight","borderBottom","borderLeft"];module.exports=React.createClass({shouldComponentUpdate:function(e,t){return Boolean(e.el)&&(this.props.el!==e.el||t.idx!==this.state.idx)},getInitialState:function(){return{idx:0}},render:function(){var e=this,t=this.state.idx,r=sides[t],i=this.props,l=i.el,d=i.tab,o=i.cmd,s=i.palette,a=i.borderWidth,n=i.borderStyle;return v("li",v("span",{onClick:function(r){return e.setState({idx:(t+1)%sides.length})}},r),v(StyleColorWidget,{name:r+"Color",tab:d,cmd:o,el:l,values:s}),v(StyleWidget,{name:r+"Width",tab:d,cmd:o,el:l,values:a}),v(StyleWidget,{name:r+"Style",tab:d,cmd:o,el:l,values:n}))}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11,"./StyleColorWidget.js":19,"./StyleWidget.js":20}],19:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,dropdown=_require.dropdown,dropdownToggle=_require.dropdownToggle;module.exports=React.createClass({shouldComponentUpdate:function(e){return Boolean(e.el)&&(this.props.el!==e.el||this.props.name!==e.name)},toggle:dropdownToggle,cmd:function(e){this.props.cmd(e),this.refs.el.firstChild.checked=!1,this.toggle({currentTarget:this.refs.el.firstChild})},render:function(){var e=this,r=this.props,t=r.name,o=r.tab,n=r.el,s=r.values,l=n?n.style[t]:"gray";return dropdown({name:t+o,onMouseDown:this.toggle,label:v("i",{className:"fa fa-tint",style:{color:l}}),content:v("div",{className:"palette"},s.map(function(r,o){return v("button",{key:o,className:r===l?"selected":null,onMouseUp:function(o){var n;return e.cmd((n={},n[t]=r===l?"":r,n))},style:{backgroundColor:r}})}))})}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11}],20:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,dropdown=_require.dropdown,dropdownToggle=_require.dropdownToggle;module.exports=React.createClass({shouldComponentUpdate:function(e){return Boolean(e.el)&&(this.props.el!==e.el||this.props.name!==e.name)},toggle:dropdownToggle,cmd:function(e){this.props.cmd(e),this.toggle({currentTarget:this.refs.el.firstChild})},render:function(){var e=this,r=this.props,o=r.name,t=r.tab,n=void 0===t?"":t,l=r.el,s=r.values,i=l?l.style[o]||getComputedStyle(l)[o]:"";return dropdown({name:o+n,onMouseDown:this.toggle,label:this.props.label||i,content:v("ul",{className:"scroll"},s.map(function(r,t){return v("li",{key:t,className:r===i?"selected":null,onMouseUp:function(t){var n;return e.cmd((n={},n[o]=r===i?"":r,n))}},r)}))})}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11}],21:[function(require,module,exports){
(function (global){
"use strict";var React=(typeof window !== "undefined" ? window['React'] : typeof global !== "undefined" ? global['React'] : null),_require=require("../utils/"),v=_require.v,_createTable=_require.createTable,dropdown=_require.dropdown,dropdownToggle=_require.dropdownToggle,min=Math.min,max=Math.max;module.exports=React.createClass({shouldComponentUpdate:function(){return!1},toggle:function(e){this.update(this.refs.picker,0,0),dropdownToggle(e)},update:function(e,r,t){for(var a=0;r>=a;a++){e.rows[a].className="active";for(var o=0;t>=o;o++)e.rows[a].cells[o].className="active selected"}if(e.rows[0].cells[t+1])for(var s=0;r>=s;s++)e.rows[s].cells[t+1].className="";if(e.rows[r+1]){e.rows[r+1].className="";for(var n=0;t>=n;n++)e.rows[r+1].cells[n].className="active";e.rows[r+1].cells[t+1]&&(e.rows[r+1].cells[t+1].className="")}this.refs.value.textContent=r+1+" x "+(t+1)},createTable:function(e,r){_createTable(e,r),this.toggle({currentTarget:this.refs.el.firstChild})},componentDidMount:function(){this.update(this.refs.picker,0,0)},render:function(){var e=this;return dropdown({name:"table-picker",onMouseDown:this.toggle,label:v("i",{className:"fa fa-table"}),content:v("div",v("table",v("tbody",{ref:"picker"},Array.from({length:this.props.cfg.m_max},function(r,t){return v("tr",{key:t},Array.from({length:e.props.cfg.n_max},function(r,a){return v("td",{key:a,onMouseUp:function(r){return e.createTable(t,a)},onMouseEnter:function(r){return e.update(e.refs.picker,t,a)}})}))}))),v("div",{className:"table-picker-value",ref:"value"}))})}});

}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{"../utils/":11}]},{},[1,3])(3)
});